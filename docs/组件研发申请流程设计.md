# ç»„ä»¶ç ”å‘ç”³è¯·æµç¨‹è®¾è®¡

## ğŸ“‹ ç›®å½•

- [1. èƒŒæ™¯ä¸ç›®æ ‡](#1-èƒŒæ™¯ä¸ç›®æ ‡)
- [2. æ ¸å¿ƒæ¦‚å¿µ](#2-æ ¸å¿ƒæ¦‚å¿µ)
- [3. çŠ¶æ€æ¨¡å‹](#3-çŠ¶æ€æ¨¡å‹)
- [4. å®Œæ•´æµç¨‹](#4-å®Œæ•´æµç¨‹)
- [5. æ•°æ®æ¨¡å‹è®¾è®¡](#5-æ•°æ®æ¨¡å‹è®¾è®¡)
- [6. APIæ¥å£è®¾è®¡](#6-apiæ¥å£è®¾è®¡)
- [7. æƒé™æ§åˆ¶](#7-æƒé™æ§åˆ¶)
- [8. ä¸šåŠ¡è§„åˆ™](#8-ä¸šåŠ¡è§„åˆ™)

---

## 1. èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 ç°çŠ¶åˆ†æ

å½“å‰ç»„ä»¶ç®¡ç†ç³»ç»Ÿï¼š

- âœ… å·²æœ‰åŠŸèƒ½ï¼šç»„ä»¶ä¸Šä¼ ã€ç‰ˆæœ¬ç®¡ç†ã€åˆ†ç±»ç®¡ç†
- âœ… ç‰ˆæœ¬çŠ¶æ€ï¼š`draft`ï¼ˆè‰ç¨¿ï¼‰ã€`published`ï¼ˆå·²å‘å¸ƒï¼‰
- âŒ ç¼ºå¤±åŠŸèƒ½ï¼šç¼ºä¹ç ”å‘ç”³è¯·å’Œå®¡æ‰¹æµç¨‹

### 1.2 ç›®æ ‡

å»ºç«‹å®Œæ•´çš„**ç»„ä»¶ç ”å‘ç”³è¯·æµç¨‹**ï¼Œå®ç°ï¼š

1. è§„èŒƒåŒ–çš„ç ”å‘ç”³è¯·ç®¡ç†
2. æ¸…æ™°çš„ç‰ˆæœ¬çŠ¶æ€æµè½¬
3. å¯è¿½æº¯çš„å®¡æ‰¹è®°å½•
4. çµæ´»çš„æ–‡ä»¶ä¸Šä¼ ä¸æ›¿æ¢æœºåˆ¶
5. **ç»Ÿä¸€çš„ä¸Šä¼ å…¥å£**ï¼ˆåºŸå¼ƒç›´æ¥ä¸Šä¼ æ¥å£ï¼‰

### 1.3 é‡è¦å†³ç­–ï¼šåºŸå¼ƒç›´æ¥ä¸Šä¼ æ¥å£

**å†³ç­–ï¼š** åºŸå¼ƒç°æœ‰çš„ `POST /api/components/upload` æ¥å£ï¼Œæ‰€æœ‰ç»„ä»¶ä¸Šä¼ å¿…é¡»é€šè¿‡ç ”å‘ç”³è¯·æµç¨‹ã€‚

**åŸå› ï¼š**

| é—®é¢˜             | è¯´æ˜                                                                      |
| ---------------- | ------------------------------------------------------------------------- |
| åˆ†ç±»ä¿¡æ¯æ¥æºä¸æ¸… | abd-cli ç”Ÿæˆçš„ meta.json ä¸åŒ…å« `id`ã€`name`ã€`classification` ç­‰å…³é”®ä¿¡æ¯ |
| ç•™æœ‰åé—¨         | ç›´æ¥ä¸Šä¼ ç»•è¿‡å®¡æ‰¹æµç¨‹ï¼Œä¸è§„èŒƒåŒ–ç®¡ç†ç›®æ ‡å†²çª                                |
| æ•°æ®ä¸€è‡´æ€§       | åˆ†ç±»ä¿¡æ¯ç”±å¼€å‘è€…è‡ªè¡Œå¡«å†™ï¼Œå¯èƒ½ä¸ç³»ç»Ÿåˆ†ç±»ä¸ä¸€è‡´                            |
| å¯è¿½æº¯æ€§         | ç›´æ¥ä¸Šä¼ ç¼ºä¹ç”³è¯·è®°å½•ï¼Œæ— æ³•å®¡è®¡                                            |

**æ›¿ä»£æ–¹æ¡ˆï¼ˆç®¡ç†å‘˜å¿«é€Ÿä¸Šä¼ ï¼‰ï¼š**

ç®¡ç†å‘˜å¯é€šè¿‡ã€Œè‡ªåŠ©å®¡æ‰¹ã€æƒé™å®ç°å¿«é€Ÿä¸Šä¼ ï¼š

```
1. åˆ›å»ºç ”å‘ç”³è¯·ï¼ˆå¡«å†™ç»„ä»¶ä¿¡æ¯ï¼‰
2. å¯¼å‡º supplement æ–‡ä»¶
3. æ„å»ºå¹¶ä¸Šä¼ ç»„ä»¶åŒ…
4. è‡ªå·±å®¡æ‰¹é€šè¿‡ï¼ˆç‰¹æ®Šæƒé™ï¼šdevelopment:application:self-approveï¼‰
```

**è¿ç§»è®¡åˆ’ï¼š**

1. âœ… æ–°å»ºç ”å‘ç”³è¯·æ¨¡å—
2. âœ… æ ‡è®°æ—§æ¥å£ä¸º `@Deprecated`
3. âœ… å‰ç«¯è·³è½¬åˆ°æ–°æµç¨‹
4. âœ… ä¸‹ä¸ªç‰ˆæœ¬å®Œå…¨ç§»é™¤æ—§æ¥å£

---

## 2. æ ¸å¿ƒæ¦‚å¿µ

### 2.1 ç ”å‘ç”³è¯·ï¼ˆDevelopment Applicationï¼‰

- æ¯æ¬¡æ–°å¢ç»„ä»¶ç‰ˆæœ¬éƒ½éœ€è¦åˆ›å»ºç ”å‘ç”³è¯·
- ä¸€ä¸ªç”³è¯·å¯¹åº”ä¸€ä¸ªç»„ä»¶ç‰ˆæœ¬çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ
- ç”³è¯·åŒ…å«ï¼šåŸºæœ¬ä¿¡æ¯ã€ç‰ˆæœ¬ä¿¡æ¯ã€ä¸Šä¼ æ–‡ä»¶ã€å®¡æ‰¹è®°å½•

### 2.2 é€‚ç”¨åœºæ™¯

| åœºæ™¯           | è¯´æ˜                  | è¦æ±‚                                               |
| -------------- | --------------------- | -------------------------------------------------- |
| **æ–°ç»„ä»¶åˆ›å»º** | é¦–æ¬¡åˆ›å»ºç»„ä»¶          | éœ€å¡«å†™ componentIdã€nameã€é€‰æ‹©åˆ†ç±»ï¼Œé»˜è®¤ç‰ˆæœ¬ 1.0.0 |
| **ç‰ˆæœ¬è¿­ä»£**   | ä¸ºå·²æœ‰ç»„ä»¶æ·»åŠ æ–°ç‰ˆæœ¬  | é€‰æ‹©å·²æœ‰ç»„ä»¶ï¼Œå¡«å†™æ–°ç‰ˆæœ¬å·ï¼ˆä¸èƒ½å†²çªï¼‰             |
| **æ›¿æ¢ç‰ˆæœ¬**   | æ›¿æ¢å·²æœ‰çš„ draft ç‰ˆæœ¬ | é€‰æ‹©å·²æœ‰ç»„ä»¶å’Œ draft ç‰ˆæœ¬ï¼Œä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·          |

### 2.3 ç»„ä»¶å…ƒæ•°æ®æ–‡ä»¶æ‹†åˆ†

ä¸ºäº†æ›´å¥½åœ°ç®¡ç†ç»„ä»¶ç ”å‘æµç¨‹ï¼Œç»„ä»¶å…ƒæ•°æ®è¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼š

#### A. component.meta.supplement.jsonï¼ˆè¡¥å……æ–‡ä»¶ï¼‰

**æ¥æºï¼š** ç”±ç ”å‘ç”³è¯·ç³»ç»Ÿç”Ÿæˆæˆ–å¯¼å‡º  
**ç”Ÿæˆæ—¶æœºï¼š**

- **æ–°ç»„ä»¶åˆ›å»º**ï¼šæ ¹æ®ç”¨æˆ·å¡«å†™çš„ä¿¡æ¯ç”Ÿæˆ
- **ç‰ˆæœ¬è¿­ä»£**ï¼šæ ¹æ®å·²æœ‰ç»„ä»¶ä¿¡æ¯ + ç”¨æˆ·å¡«å†™çš„æ–°ç‰ˆæœ¬å·ç”Ÿæˆ
- **æ›¿æ¢ç‰ˆæœ¬**ï¼šå¯¼å‡ºç°æœ‰ç‰ˆæœ¬çš„ supplement æ–‡ä»¶

**ä½œç”¨ï¼š** åŒ…å«ç»„ä»¶çš„åŸºæœ¬æ ‡è¯†å’Œåˆ†ç±»ä¿¡æ¯

```json
{
  "id": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "version": "1.0.0",
  "classification": {
    "level1": "table",
    "level2": "data-grid",
    "displayName": {
      "level1": "è¡¨æ ¼",
      "level2": "æ•°æ®è¡¨æ ¼"
    }
  }
}
```

**å­—æ®µè¯´æ˜ï¼š**

- `id`ï¼šç»„ä»¶å”¯ä¸€æ ‡è¯†
- `name`ï¼šç»„ä»¶ä¸­æ–‡åç§°
- `version`ï¼šç‰ˆæœ¬å·
- `classification`ï¼šåˆ†ç±»ä¿¡æ¯ï¼ˆå«æ ‡è¯†å’Œæ˜¾ç¤ºåç§°ï¼‰

**å®‰å…¨æœºåˆ¶ï¼š**

- ğŸ”’ **é˜¶æ®µ1ï¼ˆå½“å‰ï¼‰**ï¼šä¸Šä¼ æ—¶é€å­—æ®µæ ¡éªŒæ–‡ä»¶å†…å®¹ä¸ç”³è¯·ä¿¡æ¯æ˜¯å¦ä¸€è‡´
  - é˜²æ­¢ç”¨æˆ·é”™è¯¯æ“ä½œï¼ˆä¸Šä¼ é”™è¯¯çš„ supplement æ–‡ä»¶ï¼‰
  - é˜²æ­¢æ¶æ„ç¯¡æ”¹æ–‡ä»¶å†…å®¹
  - é˜²æ­¢ç”³è¯·ä¿¡æ¯å˜æ›´åä½¿ç”¨æ—§æ–‡ä»¶
- ğŸ”’ **é˜¶æ®µ2ï¼ˆç­¾åæœºåˆ¶ï¼‰**ï¼šå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ•°å­—ç­¾åï¼Œç®€åŒ–æ ¡éªŒæµç¨‹
  - supplement æ–‡ä»¶ä¸­åŒ…å« `applicationId` å’Œ `signature` å­—æ®µ
  - ä¸Šä¼ æ—¶éªŒè¯ï¼š
    1. åŸºç¡€æ ¼å¼ï¼ˆJSON æ ¼å¼ã€å¿…éœ€å­—æ®µï¼‰
    2. ç­¾åæœ‰æ•ˆæ€§ï¼ˆé˜²ç¯¡æ”¹ï¼‰
    3. applicationId åŒ¹é…ï¼ˆé˜²é”™ä¼ ï¼‰
  - çœç•¥é€å­—æ®µå¯¹æ¯”ï¼Œæå‡æ€§èƒ½
  - âš ï¸ æ³¨æ„ï¼šä¸æ˜¯å®Œå…¨ä¸æ ¡éªŒï¼Œè€Œæ˜¯ä»"5ä¸ªå­—æ®µå¯¹æ¯”"ç®€åŒ–ä¸º"ç­¾å+IDéªŒè¯"

---

#### B. component.meta.jsonï¼ˆæ„å»ºæ–‡ä»¶ï¼‰

**æ¥æºï¼š** ç”± `abd-cli` å·¥å…·åœ¨æ„å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆ  
**æ—¶æœºï¼š** ç»„ä»¶æ„å»ºæ‰“åŒ…æ—¶  
**ä½œç”¨ï¼š** åŒ…å«ç»„ä»¶çš„æŠ€æœ¯ç»†èŠ‚å’Œæ„å»ºä¿¡æ¯

```json
{
  "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶",
  "type": "vue-component",
  "framework": "vue3",
  "author": {
    "organization": "æ±Ÿè‹ç”µåŠ›å…¬å¸",
    "userName": "zhangsan"
  },
  "files": {
    "entry": "index.esm.js",
    "style": "style.css",
    "preview": "assets/preview.png"
  },
  "buildInfo": {
    "buildTime": "2026-01-07T10:30:00.000Z",
    "hash": "ea8bede9",
    "cliVersion": "1.0.0"
  },
  "license": "MIT"
}
```

**å­—æ®µè¯´æ˜ï¼š**

- `description`ï¼šç»„ä»¶æè¿°
- `type`ï¼šç»„ä»¶æ¨¡æ¿ç±»å‹
- `framework`ï¼šå¼€å‘æ¡†æ¶
- `author`ï¼šä½œè€…ä¿¡æ¯
- `files`ï¼šæ–‡ä»¶è·¯å¾„é…ç½®
- `buildInfo`ï¼šæ„å»ºä¿¡æ¯
- `license`ï¼šè®¸å¯è¯

---

#### C. ä¸¤ä¸ªæ–‡ä»¶çš„å…³ç³»

```
component.meta.supplement.json  +  component.meta.json  =  å®Œæ•´çš„ç»„ä»¶å…ƒæ•°æ®
  (ç”³è¯·ç³»ç»Ÿç”Ÿæˆ/å¯¼å‡º)                  (abd-cli ç”Ÿæˆ)              (ç³»ç»Ÿåˆå¹¶)
         â†“                                   â†“                          â†“
     åŸºæœ¬ä¿¡æ¯                            æŠ€æœ¯ä¿¡æ¯                   å…¥åº“ä¿¡æ¯
  (id, name, version)              (description, files)      (Component + Version)
```

**æ–‡ä»¶æ¥æºæ€»ç»“ï¼š**

| åœºæ™¯           | supplement æ–‡ä»¶æ¥æº           | meta æ–‡ä»¶æ¥æº    | ä¸Šä¼ æ—¶è¦æ±‚         |
| -------------- | ----------------------------- | ---------------- | ------------------ |
| **æ–°ç»„ä»¶åˆ›å»º** | ç³»ç»Ÿæ ¹æ®ç”¨æˆ·å¡«å†™ä¿¡æ¯ç”Ÿæˆ      | abd-cli æ„å»ºç”Ÿæˆ | ä¸¤ä¸ªæ–‡ä»¶éƒ½å¿…é¡»å­˜åœ¨ |
| **ç‰ˆæœ¬è¿­ä»£**   | ç³»ç»Ÿæ ¹æ®å·²æœ‰ç»„ä»¶+æ–°ç‰ˆæœ¬å·ç”Ÿæˆ | abd-cli æ„å»ºç”Ÿæˆ | ä¸¤ä¸ªæ–‡ä»¶éƒ½å¿…é¡»å­˜åœ¨ |
| **æ›¿æ¢ç‰ˆæœ¬**   | ç³»ç»Ÿå¯¼å‡ºç°æœ‰ç‰ˆæœ¬çš„ supplement | abd-cli æ„å»ºç”Ÿæˆ | ä¸¤ä¸ªæ–‡ä»¶éƒ½å¿…é¡»å­˜åœ¨ |

**éªŒè¯è§„åˆ™ï¼š**

1. âœ… ä¸¤ä¸ªæ–‡ä»¶å¿…é¡»åŒæ—¶å­˜åœ¨ï¼ˆæ‰€æœ‰åœºæ™¯ï¼‰
2. âœ… `component.meta.supplement.json` çš„ä¿¡æ¯å¿…é¡»ä¸ç”³è¯·ä¸€è‡´
3. âœ… `component.meta.json` å¿…é¡»åŒ…å«å¿…éœ€å­—æ®µ
4. âœ… æ–‡ä»¶ç»“æ„å’Œå†…å®¹å¿…é¡»ç¬¦åˆ JSON Schema

---

## 3. çŠ¶æ€æ¨¡å‹

### 3.1 ç ”å‘ç”³è¯·çŠ¶æ€ï¼ˆDevelopment Statusï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç»„ä»¶ç ”å‘ç”³è¯·çŠ¶æ€æµè½¬                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  pending_info        å¾…å®Œå–„ä¿¡æ¯ï¼ˆåˆå§‹çŠ¶æ€ï¼‰
      â†“
  awaiting_upload     ç­‰å¾…ä¸Šä¼ ï¼ˆä¿¡æ¯å·²å®Œå–„ï¼‰
      â†“
  uploaded            å·²ä¸Šä¼ ï¼ˆå¾…å®¡æ ¸ï¼‰
      â†“                     â†“
  approved            â†“     rejected
  (å®¡æ ¸é€šè¿‡)          â†“     (å®¡æ ¸ä¸é€šè¿‡)
      â†“               â†“          â†“
  completed           â†“     awaiting_upload
  (å·²å®Œæˆ)            â†“     (å›åˆ°ç­‰å¾…ä¸Šä¼ )
                      â†“
                  cancelled
                  (å·²å–æ¶ˆ)
```

#### çŠ¶æ€å®šä¹‰

| çŠ¶æ€ä»£ç           | çŠ¶æ€åç§°     | è¯´æ˜                         | å¯æ‰§è¡Œæ“ä½œ                             |
| ----------------- | ------------ | ---------------------------- | -------------------------------------- |
| `pending_info`    | å¾…å®Œå–„ä¿¡æ¯   | ç ”å‘ç”³è¯·åˆšåˆ›å»ºï¼Œä¿¡æ¯å°šæœªå®Œå–„ | ç¼–è¾‘ä¿¡æ¯ã€å–æ¶ˆç”³è¯·                     |
| `awaiting_upload` | ç­‰å¾…ä¸Šä¼      | ä¿¡æ¯å·²å®Œå–„ï¼Œç­‰å¾…ä¸Šä¼ ç»„ä»¶åŒ…   | ä¸Šä¼ æ–‡ä»¶ã€ç¼–è¾‘ä¿¡æ¯ã€å–æ¶ˆç”³è¯·           |
| `uploaded`        | å·²ä¸Šä¼ å¾…å®¡æ ¸ | ç»„ä»¶åŒ…å·²ä¸Šä¼ ï¼Œç­‰å¾…å®¡æ ¸       | åˆ é™¤ä¸Šä¼ æ–‡ä»¶ï¼ˆå›åˆ°ç­‰å¾…ä¸Šä¼ ï¼‰ã€æäº¤å®¡æ ¸ |
| `under_review`    | å®¡æ ¸ä¸­       | å·²æäº¤å®¡æ ¸ï¼Œå®¡æ ¸äººå‘˜å¤„ç†ä¸­   | å®¡æ ¸é€šè¿‡ã€å®¡æ ¸ä¸é€šè¿‡                   |
| `rejected`        | å®¡æ ¸ä¸é€šè¿‡   | å®¡æ ¸æœªé€šè¿‡ï¼Œéœ€é‡æ–°ä¸Šä¼        | ä¸Šä¼ æ–°æ–‡ä»¶ã€æŸ¥çœ‹å®¡æ ¸æ„è§               |
| `approved`        | å®¡æ ¸é€šè¿‡     | å®¡æ ¸é€šè¿‡ï¼Œç‰ˆæœ¬å˜ä¸º draft     | å‘å¸ƒç‰ˆæœ¬                               |
| `completed`       | å·²å®Œæˆ       | ç‰ˆæœ¬å·²å‘å¸ƒä¸º published       | æŸ¥çœ‹è¯¦æƒ…                               |
| `cancelled`       | å·²å–æ¶ˆ       | ç”³è¯·å·²å–æ¶ˆ                   | æŸ¥çœ‹è¯¦æƒ…                               |

### 3.2 ç»„ä»¶ç‰ˆæœ¬çŠ¶æ€ï¼ˆVersion Statusï¼‰

ä¿æŒç°æœ‰çŠ¶æ€ä¸å˜ï¼Œæ–°å¢å…³è”å…³ç³»ï¼š

| çŠ¶æ€        | è¯´æ˜   | ä¸ç ”å‘ç”³è¯·çš„å…³ç³»       |
| ----------- | ------ | ---------------------- |
| `draft`     | è‰ç¨¿   | ç ”å‘ç”³è¯·å®¡æ ¸é€šè¿‡ååˆ›å»º |
| `published` | å·²å‘å¸ƒ | ä» draft å‘å¸ƒè€Œæ¥      |

---

## 4. å®Œæ•´æµç¨‹

### 4.1 æµç¨‹å›¾ï¼ˆMermaidï¼‰

```mermaid
flowchart TD
    Start([å¼€å§‹]) --> Choice{ç»„ä»¶ç±»å‹}

    Choice -->|æ–°ç»„ä»¶| NewComp[å¡«å†™ç»„ä»¶ä¿¡æ¯<br/>componentId, name, åˆ†ç±»]
    Choice -->|å·²æœ‰ç»„ä»¶| ExistComp[é€‰æ‹©å·²æœ‰ç»„ä»¶]

    NewComp --> VersionInput[è¾“å…¥ç‰ˆæœ¬å·<br/>é»˜è®¤ 1.0.0]
    ExistComp --> VersionCheck{æ£€æŸ¥ç‰ˆæœ¬å†²çª}

    VersionCheck -->|ç‰ˆæœ¬å·²å­˜åœ¨| VersionInput2[è¾“å…¥æ–°ç‰ˆæœ¬å·]
    VersionCheck -->|ç‰ˆæœ¬å¯ç”¨| VersionInput2
    VersionInput2 --> CreateApp[åˆ›å»ºç ”å‘ç”³è¯·]

    VersionInput --> CreateApp
    CreateApp --> State1[çŠ¶æ€: pending_info]

    State1 --> CompleteInfo{ä¿¡æ¯æ˜¯å¦å®Œæ•´?}
    CompleteInfo -->|å¦| EditInfo[è¡¥å……å®Œå–„ä¿¡æ¯]
    EditInfo --> CompleteInfo
    CompleteInfo -->|æ˜¯| State2[çŠ¶æ€: awaiting_upload]

    State2 --> Upload[ä¸Šä¼ ç»„ä»¶ .zip åŒ…]
    Upload --> Validate{æ–‡ä»¶éªŒè¯}

    Validate -->|å¤±è´¥| ErrorMsg[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    ErrorMsg --> State2

    Validate -->|æˆåŠŸ| State3[çŠ¶æ€: uploaded]

    State3 --> UserChoice1{ç”¨æˆ·æ“ä½œ}
    UserChoice1 -->|åˆ é™¤æ–‡ä»¶| DeleteFile[åˆ é™¤ä¸Šä¼ åŒ…]
    DeleteFile --> State2
    UserChoice1 -->|æäº¤å®¡æ ¸| State4[çŠ¶æ€: under_review]

    State4 --> Review{å®¡æ ¸äººå‘˜å®¡æ ¸}

    Review -->|ä¸é€šè¿‡| State5[çŠ¶æ€: rejected]
    State5 --> ViewReason[æŸ¥çœ‹å®¡æ ¸æ„è§]
    ViewReason --> State2

    Review -->|é€šè¿‡| State6[çŠ¶æ€: approved]
    State6 --> CreateVersion[åˆ›å»º ComponentVersion<br/>status = draft]

    CreateVersion --> State7[çŠ¶æ€: completed]
    State7 --> Publish{æ˜¯å¦å‘å¸ƒ?}

    Publish -->|æ˜¯| UpdateVersion[æ›´æ–°ç‰ˆæœ¬çŠ¶æ€<br/>draft â†’ published]
    Publish -->|å¦| End1([ç»“æŸ: ä¿æŒ draft])

    UpdateVersion --> End2([ç»“æŸ: ç‰ˆæœ¬å·²å‘å¸ƒ])

    State1 -.å–æ¶ˆ.-> Cancelled[çŠ¶æ€: cancelled]
    State2 -.å–æ¶ˆ.-> Cancelled
    Cancelled --> End3([ç»“æŸ: å·²å–æ¶ˆ])

    style State1 fill:#FFF9C4
    style State2 fill:#E1F5FE
    style State3 fill:#E1BEE7
    style State4 fill:#FFCCBC
    style State5 fill:#FFCDD2
    style State6 fill:#C8E6C9
    style State7 fill:#A5D6A7
    style Cancelled fill:#CFD8DC
```

### 4.2 è¯¦ç»†æ­¥éª¤è¯´æ˜

#### æ­¥éª¤ 1ï¼šå‘èµ·ç ”å‘ç”³è¯·

**ç”¨æˆ·é€‰æ‹©ç»„ä»¶ç±»å‹ï¼š**

##### A. æ–°ç»„ä»¶

```json
{
  "applicationType": "new",
  "componentId": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶",
  "classificationLevel1": "table",
  "classificationLevel2": "data-grid",
  "version": "1.0.0",
  "changelog": "åˆå§‹ç‰ˆæœ¬"
}
```

**ç³»ç»Ÿæ ¡éªŒï¼š**

- âœ… componentId å…¨å±€å”¯ä¸€
- âœ… åˆ†ç±»æ˜¯å¦å­˜åœ¨
- âœ… ç‰ˆæœ¬å·æ ¼å¼ï¼ˆSemverï¼‰

##### B. å·²æœ‰ç»„ä»¶æ–°ç‰ˆæœ¬

```json
{
  "applicationType": "version",
  "componentId": "BarChart",
  "version": "2.1.0",
  "changelog": "æ–°å¢æ•°æ®é’»å–åŠŸèƒ½"
}
```

**ç³»ç»Ÿæ ¡éªŒï¼š**

- âœ… ç»„ä»¶æ˜¯å¦å­˜åœ¨
- âœ… ç‰ˆæœ¬å·ä¸å†²çª
- âœ… ç‰ˆæœ¬å·å¤§äºç°æœ‰æœ€é«˜ç‰ˆæœ¬

**ç”Ÿæˆç»“æœï¼š**

- åˆ›å»º `DevelopmentApplication` è®°å½•
- çŠ¶æ€ï¼š`pending_info`
- ç”Ÿæˆç”³è¯·å•å·ï¼š`APP-20260107-0001`
- ğŸ¯ **è‡ªåŠ¨ç”Ÿæˆ `component.meta.supplement.json`**

##### C. æ›¿æ¢å·²æœ‰ç‰ˆæœ¬

**é€‚ç”¨åœºæ™¯ï¼š** æ›¿æ¢å¤„äº `draft` çŠ¶æ€çš„ç‰ˆæœ¬  
**é™åˆ¶æ¡ä»¶ï¼š** åªèƒ½æ›¿æ¢ draft çŠ¶æ€ï¼Œpublished çŠ¶æ€ä¸å¯æ›¿æ¢

```json
{
  "applicationType": "replace",
  "componentId": "BarChart",
  "version": "2.0.0",
  "existingVersionId": 123,
  "changelog": "ä¿®å¤æ€§èƒ½é—®é¢˜ï¼Œä¼˜åŒ–æ¸²æŸ“é€»è¾‘"
}
```

**ç³»ç»Ÿæ ¡éªŒï¼š**

- âœ… ç»„ä»¶æ˜¯å¦å­˜åœ¨
- âœ… ç›®æ ‡ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨
- âœ… ç›®æ ‡ç‰ˆæœ¬çŠ¶æ€æ˜¯å¦ä¸º `draft`
- âŒ `published` çŠ¶æ€çš„ç‰ˆæœ¬ä¸èƒ½è¢«æ›¿æ¢

**ç”Ÿæˆç»“æœï¼š**

- åˆ›å»º `DevelopmentApplication` è®°å½•
- å…³è”ç°æœ‰ç‰ˆæœ¬ID
- ğŸ¯ **å¯¼å‡ºç°æœ‰ç‰ˆæœ¬çš„ `component.meta.supplement.json`**

**æ›¿æ¢ç‰ˆæœ¬ä¸æ–°ç‰ˆæœ¬çš„åŒºåˆ«ï¼š**

| é¡¹ç›®                    | æ–°å»ºç‰ˆæœ¬                      | æ›¿æ¢ç‰ˆæœ¬                       |
| ----------------------- | ----------------------------- | ------------------------------ |
| **ç‰ˆæœ¬å·**              | å¿…é¡»ä¸åŒäºå·²æœ‰ç‰ˆæœ¬            | ä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·                 |
| **ç›®æ ‡çŠ¶æ€**            | åˆ›å»ºæ–°çš„ ComponentVersion     | æ›´æ–°ç°æœ‰ ComponentVersion      |
| **ç”³è¯·ç±»å‹**            | `version`                     | `replace`                      |
| **supplement æ–‡ä»¶æ¥æº** | ç³»ç»Ÿæ ¹æ®å·²æœ‰ç»„ä»¶+æ–°ç‰ˆæœ¬å·ç”Ÿæˆ | å¯¼å‡ºç°æœ‰ç‰ˆæœ¬çš„ supplement æ–‡ä»¶ |
| **meta æ–‡ä»¶æ¥æº**       | abd-cli æ„å»ºç”Ÿæˆ              | abd-cli æ„å»ºç”Ÿæˆ               |

---

#### æ­¥éª¤ 1.5ï¼šå¯¼å‡ºç»„ä»¶å…ƒæ•°æ®æ–‡ä»¶

åˆ›å»ºç”³è¯·åï¼Œç³»ç»Ÿæä¾›æ–‡ä»¶å¯¼å‡ºåŠŸèƒ½ï¼š

**å¯¼å‡ºæ¥å£ï¼š**

```
GET /api/development-applications/:id/export-meta
```

**å“åº”å¤´ï¼š**

```
Content-Type: application/json
Content-Disposition: attachment; filename="component.meta.supplement.json"
```

---

##### A. æ–°ç»„ä»¶åˆ›å»º

**supplement æ–‡ä»¶ç”Ÿæˆè§„åˆ™ï¼š**

- ç³»ç»Ÿæ ¹æ®ç”¨æˆ·å¡«å†™çš„ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ
- åŒ…å«ï¼šcomponentIdã€nameã€versionï¼ˆé»˜è®¤1.0.0ï¼‰ã€åˆ†ç±»

**æ–‡ä»¶å†…å®¹ï¼š**

```json
{
  "id": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "version": "1.0.0",
  "classification": {
    "level1": "table",
    "level2": "data-grid",
    "displayName": {
      "level1": "è¡¨æ ¼",
      "level2": "æ•°æ®è¡¨æ ¼"
    }
  }
}
```

---

##### B. ç‰ˆæœ¬è¿­ä»£ï¼ˆæ–°ç‰ˆæœ¬ï¼‰

**supplement æ–‡ä»¶ç”Ÿæˆè§„åˆ™ï¼š**

- ç³»ç»Ÿæ ¹æ®**å·²æœ‰ç»„ä»¶ä¿¡æ¯** + **ç”¨æˆ·å¡«å†™çš„æ–°ç‰ˆæœ¬å·**ç”Ÿæˆ
- ç»§æ‰¿ç»„ä»¶çš„ componentIdã€nameã€åˆ†ç±»
- ä½¿ç”¨ç”¨æˆ·å¡«å†™çš„æ–°ç‰ˆæœ¬å·

**æ–‡ä»¶å†…å®¹ï¼š**

```json
{
  "id": "BarChart",
  "name": "æŸ±çŠ¶å›¾",
  "version": "2.1.0",
  "classification": {
    "level1": "chart",
    "level2": "bar",
    "displayName": {
      "level1": "å›¾è¡¨",
      "level2": "æŸ±çŠ¶å›¾"
    }
  }
}
```

---

##### C. æ›¿æ¢ç‰ˆæœ¬

**supplement æ–‡ä»¶ç”Ÿæˆè§„åˆ™ï¼š**

- ç³»ç»Ÿ**å¯¼å‡º**ç°æœ‰ draft ç‰ˆæœ¬çš„ supplement æ–‡ä»¶
- ä¿æŒæ‰€æœ‰ä¿¡æ¯ä¸å˜ï¼ˆcomponentIdã€nameã€versionã€åˆ†ç±»ï¼‰

**æ–‡ä»¶å†…å®¹ï¼š**

```json
{
  "id": "BarChart",
  "name": "æŸ±çŠ¶å›¾",
  "version": "2.0.0",
  "classification": {
    "level1": "chart",
    "level2": "bar",
    "displayName": {
      "level1": "å›¾è¡¨",
      "level2": "æŸ±çŠ¶å›¾"
    }
  }
}
```

**æ³¨æ„ï¼š** æ›¿æ¢ç‰ˆæœ¬æ—¶ï¼Œsupplement æ–‡ä»¶æ˜¯ä»ç°æœ‰ç‰ˆæœ¬å¯¼å‡ºçš„ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•å†…å®¹ã€‚

---

**é€šç”¨æ“ä½œæµç¨‹ï¼ˆé€‚ç”¨æ‰€æœ‰åœºæ™¯ï¼‰ï¼š**

1. ğŸ“¥ ç‚¹å‡»"å¯¼å‡ºå…ƒæ•°æ®æ–‡ä»¶"æŒ‰é’®
2. ğŸ’¾ ä¸‹è½½ `component.meta.supplement.json`
3. ğŸ“‚ å°†æ–‡ä»¶æ”¾å…¥ç»„ä»¶åŒ…æ ¹ç›®å½•
4. ğŸ”¨ ä½¿ç”¨ `abd-cli` æ„å»ºç»„ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆ `component.meta.json`ï¼‰
5. ğŸ“¦ æ‰“åŒ… .zip æ–‡ä»¶ï¼ˆ**å¿…é¡»åŒ…å«ä¸¤ä¸ª meta æ–‡ä»¶**ï¼‰
6. â¬†ï¸ ä¸Šä¼ ç»„ä»¶åŒ…

**æ–‡ä»¶æ”¾ç½®ç¤ºä¾‹ï¼š**

```
MyComponent/
â”œâ”€â”€ component.meta.supplement.json  â† ä»ç”³è¯·ç³»ç»Ÿå¯¼å‡ºï¼ˆç³»ç»Ÿç”Ÿæˆæˆ–å¯¼å‡ºï¼‰
â”œâ”€â”€ component.meta.json              â† abd-cli æ„å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆ
â”œâ”€â”€ src/
â”‚   â””â”€â”€ index.vue
â”œâ”€â”€ package.json
â””â”€â”€ ...
```

---

#### æ­¥éª¤ 2ï¼šå®Œå–„ä¿¡æ¯æ¸…å•

**ç”³è¯·ä¿¡æ¯ï¼ˆå­˜å‚¨åœ¨æ•°æ®åº“ï¼‰ï¼š**

```json
{
  "id": 1,
  "applicationNo": "APP-20260107-0001",
  "applicationType": "new",
  "componentId": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶",
  "classificationLevel1": "table",
  "classificationLevel2": "data-grid",
  "targetVersion": "1.0.0",
  "changelog": "åˆå§‹ç‰ˆæœ¬",
  "developmentStatus": "pending_info",
  "applicantId": 10,
  "createdAt": "2026-01-07T10:30:00Z"
}
```

**å‰ç«¯å±•ç¤ºçš„æ“ä½œæŒ‡å—ï¼ˆä¸å­˜æ•°æ®åº“ï¼Œä»…ç”¨äºUIå±•ç¤ºï¼‰ï¼š**

```typescript
// å‰ç«¯ç»„ä»¶ï¼šApplicationGuide.vue
const guideInfo = {
  // 1. åŸºæœ¬ä¿¡æ¯å±•ç¤ºï¼ˆæ¥è‡ªç”³è¯·æ•°æ®ï¼‰
  basicInfo: {
    applicationNo: application.applicationNo,
    componentId: application.componentId,
    name: application.name,
    version: application.targetVersion,
    classification: `${application.classificationLevel1} / ${application.classificationLevel2}`
  },

  // 2. ç³»ç»Ÿé¢„å®šä¹‰çš„ä¸Šä¼ è§„åˆ™ï¼ˆå†™æ­»çš„é…ç½®ï¼‰
  uploadRequirements: {
    fileType: '.zip',
    maxSize: '50MB',
    requiredFiles: [
      'component.meta.supplement.json ï¼ˆä»ç”³è¯·ç³»ç»Ÿå¯¼å‡ºï¼‰',
      'component.meta.json ï¼ˆabd-cli æ„å»ºç”Ÿæˆï¼‰',
      'index.esm.js æˆ–å…¶ä»–å…¥å£æ–‡ä»¶'
    ],
    optionalFiles: ['style.css ï¼ˆæ ·å¼æ–‡ä»¶ï¼‰', 'assets/preview.png ï¼ˆé¢„è§ˆå›¾ï¼‰']
  },

  // 3. æ“ä½œæ­¥éª¤æŒ‡å¼•ï¼ˆå†™æ­»çš„é…ç½®ï¼‰
  steps: [
    '1ï¸âƒ£ ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¯¼å‡º component.meta.supplement.json',
    '2ï¸âƒ£ å°†å¯¼å‡ºçš„æ–‡ä»¶æ”¾å…¥ç»„ä»¶åŒ…æ ¹ç›®å½•',
    '3ï¸âƒ£ ä½¿ç”¨ abd-cli æ„å»ºç»„ä»¶ï¼ˆä¼šè‡ªåŠ¨ç”Ÿæˆ component.meta.jsonï¼‰',
    '4ï¸âƒ£ å°†ä¸¤ä¸ª meta æ–‡ä»¶å’Œç»„ä»¶ä»£ç ä¸€èµ·æ‰“åŒ…æˆ .zip',
    '5ï¸âƒ£ ä¸Šä¼  .zip æ–‡ä»¶åˆ°æœ¬é¡µé¢'
  ]
}
```

**è®¾è®¡è¯´æ˜ï¼š**

- âœ… **ç”³è¯·ä¿¡æ¯**ï¼šå­˜å‚¨åœ¨æ•°æ®åº“çš„ `development_applications` è¡¨ä¸­
- âœ… **ä¸Šä¼ è§„åˆ™**ï¼šç³»ç»Ÿé…ç½®ï¼Œæ‰€æœ‰ç”³è¯·é€šç”¨ï¼ˆå¯ä»¥å†™åœ¨é…ç½®æ–‡ä»¶æˆ–å¸¸é‡ä¸­ï¼‰
- âœ… **æ“ä½œæŒ‡å¼•**ï¼šå‰ç«¯ UI æ–‡æ¡ˆï¼Œä¸æ¶‰åŠä¸šåŠ¡æ•°æ®
- âŒ **ä¸å­˜å‚¨ frameworkã€type**ï¼šè¿™äº›ä¿¡æ¯åœ¨ç”³è¯·é˜¶æ®µä¸çŸ¥é“ï¼Œåªæœ‰ä¸Šä¼ åä» `component.meta.json` ä¸­è§£ææ‰çŸ¥é“

**æ“ä½œæµç¨‹ï¼š**

1. ç”¨æˆ·æŸ¥çœ‹ç”³è¯·ä¿¡æ¯å’Œæ“ä½œæŒ‡å¼•
2. ç‚¹å‡»"å¯¼å‡ºå…ƒæ•°æ®æ–‡ä»¶"æŒ‰é’®
3. ç³»ç»Ÿæ ¹æ®ç”³è¯·ä¿¡æ¯ç”Ÿæˆå¹¶ä¸‹è½½ `component.meta.supplement.json`
4. ç”¨æˆ·æŒ‰ç…§æŒ‡å¼•å®Œæˆç»„ä»¶æ„å»ºå’Œæ‰“åŒ…
5. çŠ¶æ€å˜æ›´ï¼š`pending_info` â†’ `awaiting_upload`

---

#### æ­¥éª¤ 3ï¼šç­‰å¾…ä¸Šä¼ ç»„ä»¶åŒ…

**å‰ç«¯å±•ç¤ºï¼š**

- ğŸ“¤ ä¸Šä¼ åŒºåŸŸï¼šæ”¯æŒæ‹–æ‹½ .zip æ–‡ä»¶
- ğŸ“‹ ä¿¡æ¯æ¸…å•å±•ç¤º
- ğŸ“ æ–‡ä»¶è¦æ±‚è¯´æ˜

**ç”¨æˆ·æ“ä½œï¼š**

- ä¸Šä¼  .zip æ–‡ä»¶
- æ”¯æŒç¼–è¾‘ä¿¡æ¯ï¼ˆå¯è¡¥å……æè¿°ï¼‰
- å¯ä»¥å–æ¶ˆç”³è¯·

---

#### æ­¥éª¤ 4ï¼šä¸Šä¼ ç»„ä»¶åŒ…

**ç»„ä»¶åŒ…ç»“æ„è¦æ±‚ï¼š**

```
DataTable-1.0.0.zip
â”œâ”€â”€ component.meta.supplement.json  â† ç”³è¯·ç³»ç»Ÿå¯¼å‡ºï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ component.meta.json              â† abd-cli ç”Ÿæˆï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ index.esm.js                     â† ä¸»å…¥å£æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ style.css                        â† æ ·å¼æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ assets/
    â””â”€â”€ preview.png                  â† é¢„è§ˆå›¾ï¼ˆå¯é€‰ï¼‰
```

**ä¸Šä¼ æµç¨‹ï¼š**

1. ç”¨æˆ·é€‰æ‹© .zip æ–‡ä»¶
2. å‰ç«¯éªŒè¯ï¼šæ–‡ä»¶å¤§å° < 50MB
3. ä¸Šä¼ åˆ°ä¸´æ—¶å­˜å‚¨ï¼ˆOSSï¼‰
4. åç«¯éªŒè¯ï¼ˆæŒ‰é¡ºåºï¼‰ï¼š
   - âœ… è§£å‹æ–‡ä»¶
   - âœ… æ£€æŸ¥ `component.meta.supplement.json` æ˜¯å¦å­˜åœ¨
   - âœ… æ£€æŸ¥ `component.meta.json` æ˜¯å¦å­˜åœ¨
   - âœ… è§£æä¸¤ä¸ª meta æ–‡ä»¶çš„ JSON æ ¼å¼
   - âœ… **å…³é”®éªŒè¯ï¼š** supplement æ–‡ä»¶å†…å®¹ä¸ç”³è¯·ä¿¡æ¯ä¸€è‡´
   - âœ… éªŒè¯å¿…éœ€æ–‡ä»¶ï¼ˆentryã€styleã€previewï¼‰æ˜¯å¦å­˜åœ¨
   - âœ… åˆå¹¶ä¸¤ä¸ª meta æ–‡ä»¶ç”Ÿæˆå®Œæ•´å…ƒæ•°æ®

**éªŒè¯è¯¦æƒ…ï¼š**

##### A. supplement æ–‡ä»¶éªŒè¯

**é˜¶æ®µ1ï¼ˆå½“å‰ï¼‰- é€å­—æ®µæ ¡éªŒï¼š**

```typescript
// éªŒè¯è§„åˆ™
const validation = {
  id: supplement.id === application.componentId,
  name: supplement.name === application.name,
  version: supplement.version === application.targetVersion,
  level1: supplement.classification.level1 === application.classificationLevel1,
  level2: supplement.classification.level2 === application.classificationLevel2
}

if (!Object.values(validation).every((v) => v)) {
  throw new Error('component.meta.supplement.json å†…å®¹ä¸ç”³è¯·ä¿¡æ¯ä¸ä¸€è‡´')
}
```

**ä¸ºä»€ä¹ˆéœ€è¦æ ¡éªŒï¼š**

- âœ… é˜²æ­¢ç”¨æˆ·ä¸Šä¼ é”™è¯¯çš„ supplement æ–‡ä»¶ï¼ˆæœ‰å¤šä¸ªç”³è¯·æ—¶ï¼‰
- âœ… é˜²æ­¢ç”¨æˆ·æ‰‹åŠ¨ç¯¡æ”¹æ–‡ä»¶å†…å®¹
- âœ… ç¡®ä¿æ–‡ä»¶ä¸æœ€æ–°ç”³è¯·ä¿¡æ¯ä¸€è‡´

**é˜¶æ®µ2ï¼ˆç­¾åæœºåˆ¶ï¼‰- ç­¾åéªŒè¯ï¼š**

```typescript
// ç®€åŒ–çš„éªŒè¯é€»è¾‘ï¼ˆä½†ä¸æ˜¯å®Œå…¨ä¸æ ¡éªŒï¼‰
const metadata = supplement._metadata

// 1. åŸºç¡€æ ¼å¼éªŒè¯ï¼ˆä»éœ€è¦ï¼‰
if (!supplement.id || !supplement.name || !supplement.version) {
  throw new Error('supplement æ–‡ä»¶ç¼ºå°‘å¿…éœ€å­—æ®µ')
}

// 2. éªŒè¯ç­¾åï¼ˆé˜²ç¯¡æ”¹ï¼‰
const isSignatureValid = verifySignature(supplement, metadata.signature)
if (!isSignatureValid) {
  throw new Error('æ–‡ä»¶ç­¾åæ— æ•ˆï¼Œå¯èƒ½å·²è¢«ç¯¡æ”¹')
}

// 3. éªŒè¯ç”³è¯·IDåŒ¹é…ï¼ˆé˜²é”™ä¼ ï¼‰
if (metadata.applicationId !== application.id) {
  throw new Error('è¯¥æ–‡ä»¶ä¸å±äºå½“å‰ç”³è¯·')
}

// âœ… ç­¾åæœ‰æ•ˆ = å†…å®¹æœªç¯¡æ”¹ = ä¸ç”³è¯·ä¸€è‡´
// âŒ æ— éœ€é€å­—æ®µå¯¹æ¯”ï¼ˆidã€nameã€versionã€classificationï¼‰
```

**ç­¾åæœºåˆ¶çš„ä¼˜åŠ¿ï¼š**

- âœ… çœç•¥é€å­—æ®µå¯¹æ¯”ï¼ˆä» 5 ä¸ªå­—æ®µå¯¹æ¯”å‡å°‘åˆ° 2 ä¸ªéªŒè¯ï¼‰
- âœ… æ€§èƒ½æ›´é«˜ï¼ˆç­¾åéªŒè¯æ˜¯ O(1) æ“ä½œï¼‰
- âœ… æ›´å®‰å…¨ï¼ˆå¯†é’¥ä¿æŠ¤ï¼Œéš¾ä»¥ä¼ªé€ ï¼‰
- âš ï¸ ä½†ä»éœ€åŸºç¡€éªŒè¯ï¼ˆæ ¼å¼ã€å¿…éœ€å­—æ®µã€ç”³è¯·åŒ¹é…ï¼‰

##### B. å®Œæ•´æ€§éªŒè¯

```typescript
// å¿…éœ€æ–‡ä»¶æ£€æŸ¥
const requiredFiles = [
  'component.meta.supplement.json',
  'component.meta.json',
  metaJson.files.entry // å¦‚ï¼šindex.esm.js
]

// å¯é€‰æ–‡ä»¶æ£€æŸ¥
const optionalFiles = [
  metaJson.files.style, // å¦‚ï¼šstyle.css
  metaJson.files.preview // å¦‚ï¼šassets/preview.png
]
```

**éªŒè¯æˆåŠŸï¼š**

```json
{
  "applicationId": "APP-20260107-0001",
  "status": "uploaded",
  "uploadInfo": {
    "fileName": "DataTable-1.0.0.zip",
    "fileSize": 2456789,
    "uploadTime": "2026-01-07 11:00:00",
    "tempPath": "temp/APP-20260107-0001/DataTable-1.0.0.zip",
    "checksum": "sha256:abc123..."
  },
  "validationResult": {
    "supplementMatch": true,
    "metaValid": true,
    "filesComplete": true,
    "warnings": []
  }
}
```

**éªŒè¯å¤±è´¥ç¤ºä¾‹ï¼š**

```json
{
  "code": 400,
  "message": "ç»„ä»¶åŒ…éªŒè¯å¤±è´¥",
  "errors": [
    "component.meta.supplement.json ä¸­çš„ componentId ä¸ç”³è¯·ä¸ä¸€è‡´",
    "component.meta.supplement.json: æœŸæœ› 'DataTable'ï¼Œå®é™… 'DataGrid'",
    "ç¼ºå°‘å¿…éœ€æ–‡ä»¶ï¼šcomponent.meta.json"
  ]
}
```

çŠ¶æ€å˜æ›´ï¼š`awaiting_upload` â†’ `uploaded`

---

#### æ­¥éª¤ 5ï¼šå¾…å®¡æ ¸çŠ¶æ€

**ç”¨æˆ·å¯æ‰§è¡Œæ“ä½œï¼š**

- âŒ **åˆ é™¤ä¸Šä¼ åŒ…**ï¼šåˆ é™¤å·²ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå›åˆ° `awaiting_upload` çŠ¶æ€
- âœ… **æäº¤å®¡æ ¸**ï¼šå°†ç”³è¯·æäº¤ç»™å®¡æ ¸äººå‘˜
- ğŸ“„ æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯

**æäº¤å®¡æ ¸åï¼š**
çŠ¶æ€å˜æ›´ï¼š`uploaded` â†’ `under_review`

**æ“ä½œé™åˆ¶ï¼š**

- ğŸš« ä¸èƒ½å†åˆ é™¤ä¸Šä¼ åŒ…
- ğŸš« ä¸èƒ½ç¼–è¾‘ä¿¡æ¯
- âœ… å¯ä»¥æŸ¥çœ‹å®¡æ ¸è¿›åº¦

---

#### æ­¥éª¤ 6ï¼šå®¡æ ¸æµç¨‹

**å®¡æ ¸äººå‘˜æ“ä½œï¼š**

##### A. å®¡æ ¸é€šè¿‡

```json
{
  "applicationId": "APP-20260107-0001",
  "reviewAction": "approve",
  "reviewComment": "ä»£ç è´¨é‡è‰¯å¥½ï¼Œç¬¦åˆè§„èŒƒ",
  "reviewerId": 1,
  "reviewTime": "2026-01-07 14:30:00"
}
```

**ç³»ç»Ÿå¤„ç†ï¼š**

1. **ä½¿ç”¨ OSS æœåŠ¡ç«¯å¤åˆ¶**å°†ä¸´æ—¶æ–‡ä»¶è¿ç§»åˆ°æ­£å¼å­˜å‚¨è·¯å¾„
   - ä»ï¼š`temp/APP-20260107-0001/`
   - åˆ°ï¼š`components/DataTable/1.0.0/`
   - ğŸ”§ **æŠ€æœ¯æ–¹æ¡ˆ**ï¼šä½¿ç”¨ OSS CopyObject APIï¼ˆæœåŠ¡ç«¯å¤åˆ¶ï¼‰
   - âœ… **ä¼˜åŠ¿**ï¼šä¸éœ€è¦ä¸‹è½½åé‡æ–°ä¸Šä¼ ï¼ŒèŠ‚çœå¸¦å®½å’Œæ—¶é—´
   - ğŸ“‹ **å®ç°æ–¹å¼**ï¼š
     ```typescript
     // ä¼ªä»£ç ç¤ºä¾‹
     await ossClient.copy(
       `components/DataTable/1.0.0/component.zip`,
       `temp/APP-20260107-0001/component.zip`
     )
     // å¤åˆ¶æˆåŠŸååˆ é™¤ä¸´æ—¶æ–‡ä»¶
     await ossClient.delete(`temp/APP-20260107-0001/component.zip`)
     ```
2. åˆ›å»º `ComponentVersion` è®°å½•ï¼ŒçŠ¶æ€ä¸º `draft`
3. å¦‚æœæ˜¯æ–°ç»„ä»¶ï¼Œåˆ›å»º `Component` è®°å½•
4. æ›´æ–°ç”³è¯·çŠ¶æ€ï¼š`under_review` â†’ `approved`

##### B. å®¡æ ¸ä¸é€šè¿‡

```json
{
  "applicationId": "APP-20260107-0001",
  "reviewAction": "reject",
  "reviewComment": "ç¼ºå°‘ç»„ä»¶æè¿°ï¼Œpreview.png å›¾ç‰‡è´¨é‡ä¸ä½³",
  "reviewerId": 1,
  "reviewTime": "2026-01-07 14:30:00"
}
```

**ç³»ç»Ÿå¤„ç†ï¼š**

1. åˆ é™¤ä¸´æ—¶ä¸Šä¼ æ–‡ä»¶
2. æ›´æ–°ç”³è¯·çŠ¶æ€ï¼š`under_review` â†’ `rejected`
3. é€šçŸ¥ç”³è¯·äºº

**ç”³è¯·äººåç»­æ“ä½œï¼š**

- æŸ¥çœ‹å®¡æ ¸æ„è§
- ä¿®å¤é—®é¢˜åé‡æ–°ä¸Šä¼ 
- çŠ¶æ€å›åˆ°ï¼š`awaiting_upload`

---

#### æ­¥éª¤ 7ï¼šç ”å‘å®Œæˆ

**çŠ¶æ€ï¼š** `approved`

**ç‰ˆæœ¬ä¿¡æ¯ï¼š**

```json
{
  "componentId": "DataTable",
  "version": "1.0.0",
  "status": "draft",
  "entryUrl": "https://oss.example.com/components/DataTable/1.0.0/index.esm.js",
  "styleUrl": "https://oss.example.com/components/DataTable/1.0.0/style.css"
}
```

**åç»­æ“ä½œï¼š**

- âœ… å‘å¸ƒç‰ˆæœ¬ï¼š`draft` â†’ `published`
- ğŸ“„ æŸ¥çœ‹ç‰ˆæœ¬è¯¦æƒ…
- ğŸ”„ ç»§ç»­ç ”å‘æ–°ç‰ˆæœ¬

ç”³è¯·çŠ¶æ€å˜æ›´ï¼š`approved` â†’ `completed`ï¼ˆå½“ç‰ˆæœ¬å‘å¸ƒåï¼‰

---

## 5. æ•°æ®æ¨¡å‹è®¾è®¡

### 5.1 æ–°å¢å®ä½“ï¼šDevelopmentApplication

```typescript
/**
 * ç»„ä»¶ç ”å‘ç”³è¯·è¡¨
 */
@Entity('development_applications')
export class DevelopmentApplication extends BaseEntity {
  /**
   * ç”³è¯·å•å·ï¼ˆå”¯ä¸€ï¼‰
   * æ ¼å¼ï¼šAPP-YYYYMMDD-XXXX
   */
  @Column({ type: 'varchar', length: 50, unique: true, name: 'application_no' })
  applicationNo: string

  /**
   * ç”³è¯·ç±»å‹
   * new = æ–°ç»„ä»¶, version = ç‰ˆæœ¬è¿­ä»£, replace = æ›¿æ¢ç‰ˆæœ¬
   */
  @Column({ type: 'varchar', length: 20, name: 'application_type' })
  applicationType: 'new' | 'version' | 'replace'

  /**
   * ç»„ä»¶ID
   */
  @Column({ type: 'varchar', length: 100, name: 'component_id' })
  componentId: string

  /**
   * ç»„ä»¶åç§°ï¼ˆæ–°ç»„ä»¶æ—¶å¿…å¡«ï¼‰
   */
  @Column({ type: 'varchar', length: 100, nullable: true })
  name: string | null

  /**
   * ç»„ä»¶æè¿°
   */
  @Column({ type: 'text', nullable: true })
  description: string | null

  /**
   * ä¸€çº§åˆ†ç±»
   */
  @Column({ type: 'varchar', length: 50, nullable: true, name: 'classification_level1' })
  classificationLevel1: string | null

  /**
   * äºŒçº§åˆ†ç±»
   */
  @Column({ type: 'varchar', length: 50, nullable: true, name: 'classification_level2' })
  classificationLevel2: string | null

  /**
   * ä¸€çº§åˆ†ç±»æ˜¾ç¤ºåç§°ï¼ˆç”¨äºå¯¼å‡º supplement æ–‡ä»¶ï¼‰
   */
  @Column({ type: 'varchar', length: 100, nullable: true, name: 'classification_level1_name' })
  classificationLevel1Name: string | null

  /**
   * äºŒçº§åˆ†ç±»æ˜¾ç¤ºåç§°ï¼ˆç”¨äºå¯¼å‡º supplement æ–‡ä»¶ï¼‰
   */
  @Column({ type: 'varchar', length: 100, nullable: true, name: 'classification_level2_name' })
  classificationLevel2Name: string | null

  /**
   * ç›®æ ‡ç‰ˆæœ¬å·
   */
  @Column({ type: 'varchar', length: 50, name: 'target_version' })
  targetVersion: string

  /**
   * ç‰ˆæœ¬æ›´æ–°æ—¥å¿—
   */
  @Column({ type: 'text', nullable: true })
  changelog: string | null

  /**
   * ç ”å‘ç”³è¯·çŠ¶æ€
   */
  @Column({
    type: 'varchar',
    length: 20,
    default: 'pending_info',
    name: 'development_status'
  })
  developmentStatus:
    | 'pending_info'
    | 'awaiting_upload'
    | 'uploaded'
    | 'under_review'
    | 'rejected'
    | 'approved'
    | 'completed'
    | 'cancelled'

  /**
   * ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯ï¼ˆJSONï¼‰
   */
  @Column({ type: 'json', nullable: true, name: 'upload_info' })
  uploadInfo: {
    fileName?: string
    fileSize?: number
    uploadTime?: Date
    tempPath?: string
    checksum?: string
  } | null

  /**
   * å®¡æ ¸ä¿¡æ¯ï¼ˆJSONï¼‰
   */
  @Column({ type: 'json', nullable: true, name: 'review_info' })
  reviewInfo: {
    reviewerId?: number
    reviewerName?: string
    reviewTime?: Date
    reviewAction?: 'approve' | 'reject'
    reviewComment?: string
  } | null

  /**
   * å…³è”çš„ç»„ä»¶ç‰ˆæœ¬IDï¼ˆå®¡æ ¸é€šè¿‡ååˆ›å»ºï¼‰
   */
  @Column({ type: 'int', nullable: true, name: 'component_version_id' })
  componentVersionId: number | null

  /**
   * å…³è”çš„ç°æœ‰ç‰ˆæœ¬IDï¼ˆä»…æ›¿æ¢ç‰ˆæœ¬åœºæ™¯ä½¿ç”¨ï¼‰
   * å½“ applicationType = 'replace' æ—¶ï¼ŒæŒ‡å‘è¦è¢«æ›¿æ¢çš„ draft ç‰ˆæœ¬
   */
  @Column({ type: 'int', nullable: true, name: 'existing_version_id' })
  existingVersionId: number | null

  /**
   * ç”³è¯·äººID
   */
  @Column({ type: 'int', name: 'applicant_id' })
  applicantId: number

  /**
   * ç”³è¯·äººå…³ç³»
   */
  @ManyToOne(() => User)
  @JoinColumn({ name: 'applicant_id' })
  applicant: User

  /**
   * å®¡æ ¸äººID
   */
  @Column({ type: 'int', nullable: true, name: 'reviewer_id' })
  reviewerId: number | null

  /**
   * å®¡æ ¸äººå…³ç³»
   */
  @ManyToOne(() => User, { nullable: true })
  @JoinColumn({ name: 'reviewer_id' })
  reviewer: User | null

  /**
   * æäº¤å®¡æ ¸æ—¶é—´
   */
  @Column({ type: 'timestamp', nullable: true, name: 'submitted_at' })
  submittedAt: Date | null

  /**
   * å®¡æ ¸å®Œæˆæ—¶é—´
   */
  @Column({ type: 'timestamp', nullable: true, name: 'reviewed_at' })
  reviewedAt: Date | null

  /**
   * å®Œæˆæ—¶é—´ï¼ˆç‰ˆæœ¬å‘å¸ƒæ—¶é—´ï¼‰
   */
  @Column({ type: 'timestamp', nullable: true, name: 'completed_at' })
  completedAt: Date | null
}
```

### 5.2 ç´¢å¼•è®¾è®¡

```sql
-- ç”³è¯·å•å·å”¯ä¸€ç´¢å¼•
CREATE UNIQUE INDEX idx_application_no ON development_applications(application_no);

-- ç»„ä»¶IDç´¢å¼•
CREATE INDEX idx_component_id ON development_applications(component_id);

-- çŠ¶æ€ç´¢å¼•
CREATE INDEX idx_development_status ON development_applications(development_status);

-- ç”³è¯·äººç´¢å¼•
CREATE INDEX idx_applicant_id ON development_applications(applicant_id);

-- å®¡æ ¸äººç´¢å¼•
CREATE INDEX idx_reviewer_id ON development_applications(reviewer_id);

-- ç»„åˆç´¢å¼•ï¼šç»„ä»¶ID + ç‰ˆæœ¬å·
-- æ³¨æ„ï¼šä¸è®¾ä¸ºå”¯ä¸€ç´¢å¼•ï¼Œå› ä¸ºå–æ¶ˆçš„ç”³è¯·ç‰ˆæœ¬å·å¯è¢«å¤ç”¨
-- ç‰ˆæœ¬å·å”¯ä¸€æ€§é€šè¿‡ä¸šåŠ¡é€»è¾‘æ ¡éªŒï¼ˆæ’é™¤ cancelled çŠ¶æ€ï¼‰
CREATE INDEX idx_component_version
ON development_applications(component_id, target_version);

-- å…³è”ç‰ˆæœ¬ç´¢å¼•ï¼ˆç”¨äºæ›¿æ¢ç‰ˆæœ¬åœºæ™¯ï¼‰
CREATE INDEX idx_existing_version_id ON development_applications(existing_version_id);
```

**ç‰ˆæœ¬å·å”¯ä¸€æ€§æ ¡éªŒé€»è¾‘ï¼š**

```typescript
// æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦å¯ç”¨ï¼ˆæ’é™¤å·²å–æ¶ˆçš„ç”³è¯·ï¼‰
const existingApplication = await this.repository.findOne({
  where: {
    componentId,
    targetVersion,
    developmentStatus: Not(In(['cancelled']))
  }
})
if (existingApplication) {
  throw new BusinessException('ç‰ˆæœ¬å·å·²è¢«å ç”¨')
}
```

---

## 6. APIæ¥å£è®¾è®¡

### 6.1 åˆ›å»ºç ”å‘ç”³è¯·

**POST** `/api/development-applications`

**è¯·æ±‚ä½“ï¼ˆæ–°ç»„ä»¶ï¼‰ï¼š**

```json
{
  "applicationType": "new",
  "componentId": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶",
  "classificationLevel1": "table",
  "classificationLevel2": "data-grid",
  "targetVersion": "1.0.0",
  "changelog": "åˆå§‹ç‰ˆæœ¬"
}
```

**è¯·æ±‚ä½“ï¼ˆç‰ˆæœ¬è¿­ä»£ï¼‰ï¼š**

```json
{
  "applicationType": "version",
  "componentId": "BarChart",
  "targetVersion": "2.1.0",
  "changelog": "æ–°å¢æ•°æ®é’»å–åŠŸèƒ½"
}
```

**è¯·æ±‚ä½“ï¼ˆæ›¿æ¢ç‰ˆæœ¬ï¼‰ï¼š**

```json
{
  "applicationType": "replace",
  "componentId": "BarChart",
  "targetVersion": "2.0.0",
  "existingVersionId": 123,
  "changelog": "ä¿®å¤æ€§èƒ½é—®é¢˜"
}
```

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "ç ”å‘ç”³è¯·åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 1,
    "applicationNo": "APP-20260107-0001",
    "developmentStatus": "pending_info",
    "createdAt": "2026-01-07T10:30:00Z"
  }
}
```

---

### 6.2 å¯¼å‡ºç»„ä»¶å…ƒæ•°æ®æ–‡ä»¶

**GET** `/api/development-applications/:id/export-meta`

**é€‚ç”¨çŠ¶æ€ï¼š** `pending_info`ã€`awaiting_upload`

**å“åº”å¤´ï¼š**

```
Content-Type: application/json
Content-Disposition: attachment; filename="component.meta.supplement.json"
```

**å“åº”ä½“ï¼ˆæ–°ç»„ä»¶/ç‰ˆæœ¬è¿­ä»£ï¼‰ï¼š**

```json
{
  "id": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "version": "1.0.0",
  "classification": {
    "level1": "table",
    "level2": "data-grid",
    "displayName": {
      "level1": "è¡¨æ ¼",
      "level2": "æ•°æ®è¡¨æ ¼"
    }
  },
  "_metadata": {
    "applicationId": 1,
    "applicationNo": "APP-20260107-0001",
    "exportTime": "2026-01-07T10:30:00Z",
    "signature": "SHA256_HMAC_SIGNATURE_PLACEHOLDER"
  }
}
```

**è¯´æ˜ï¼š**

- `_metadata` å­—æ®µç”¨äºè¿½æº¯å’Œé˜²ç¯¡æ”¹
- `signature` å­—æ®µåœ¨é˜¶æ®µ2ï¼ˆç­¾åæœºåˆ¶ï¼‰å®ç°åå¯ç”¨
- é˜¶æ®µ1ä»éœ€é€å­—æ®µæ ¡éªŒï¼Œé˜¶æ®µ2åªéœ€éªŒè¯ç­¾å

**å“åº”ä½“ï¼ˆæ›¿æ¢ç‰ˆæœ¬ï¼‰ï¼š**

```json
{
  "id": "BarChart",
  "name": "æŸ±çŠ¶å›¾",
  "
}
```

**è¯´æ˜ï¼š** æ›¿æ¢ç‰ˆæœ¬æ—¶å¯¼å‡ºçš„æ˜¯ç°æœ‰ draft ç‰ˆæœ¬çš„åŸå§‹ supplement æ–‡ä»¶ï¼Œä¸éœ€è¦é¢å¤–çš„å…ƒæ•°æ®æ ‡è®°ã€‚ }
},
"\_metadata": {
"isReplacement": true,
"originalVersionId": 123,
"exportTime": "2026-01-07T10:30:00Z"
}
}

````

---

### 6.3 ä¸Šä¼ ç»„ä»¶åŒ…

**POST** `/api/development-applications/:id/upload`

**è¯·æ±‚ï¼š** `multipart/form-data`
- `file`: .zip æ–‡ä»¶

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ç»„ä»¶åŒ…ä¸Šä¼ æˆåŠŸ",
  "data": {
    "applicationNo": "APP-20260107-0001",
    "developmentStatus": "uploaded",
    "uploadInfo": {
      "fileName": "DataTable-1.0.0.zip",
      "fileSize": 2456789,
      "uploadTime": "2026-01-07T11:00:00Z"
    },
    "validationResult": {
      "supplementMatch": true,
      "metaValid": true,
      "filesComplete": true
    }
  }
}
````

---

### 6.4 åˆ é™¤ä¸Šä¼ åŒ…

**DELETE** `/api/development-applications/:id/upload`

**é€‚ç”¨çŠ¶æ€ï¼š** `uploaded`

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "ä¸Šä¼ åŒ…å·²åˆ é™¤",
  "data": {
    "developmentStatus": "awaiting_upload"
  }
}
```

---

### 6.5 æäº¤å®¡æ ¸

**POST** `/api/development-applications/:id/submit-review`

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "å·²æäº¤å®¡æ ¸",
  "data": {
    "developmentStatus": "under_review",
    "submittedAt": "2026-01-07T12:00:00Z"
  }
}
```

---

### 6.6 å®¡æ ¸ç”³è¯·

**POST** `/api/development-applications/:id/review`

**è¯·æ±‚ä½“ï¼š**

```json
{
  "reviewAction": "approve",
  "reviewComment": "å®¡æ ¸é€šè¿‡"
}
```

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "å®¡æ ¸å®Œæˆ",
  "data": {
    "developmentStatus": "approved",
    "componentVersionId": 123,
    "reviewInfo": {
      "reviewerId": 1,
      "reviewerName": "admin",
      "reviewAction": "approve",
      "reviewComment": "å®¡æ ¸é€šè¿‡",
      "reviewTime": "2026-01-07T14:30:00Z"
    }
  }
}
```

---

### 6.7 æŸ¥è¯¢ç”³è¯·åˆ—è¡¨

**GET** `/api/development-applications`

**æŸ¥è¯¢å‚æ•°ï¼š**

- `status`: çŠ¶æ€ç­›é€‰
- `applicationType`: ç±»å‹ç­›é€‰
- `componentId`: ç»„ä»¶IDç­›é€‰
- `applicantId`: ç”³è¯·äººç­›é€‰
- `page`: é¡µç 
- `limit`: æ¯é¡µæ•°é‡

---

### 6.8 æŸ¥è¯¢ç”³è¯·è¯¦æƒ…

**GET** `/api/development-applications/:id`

**å“åº”ï¼š**

```json
{
  "code": 200,
  "data": {
    "id": 1,
    "applicationNo": "APP-20260107-0001",
    "applicationType": "new",
    "componentId": "DataTable",
    "name": "æ•°æ®è¡¨æ ¼",
    "targetVersion": "1.0.0",
    "developmentStatus": "approved",
    "uploadInfo": { ... },
    "reviewInfo": { ... },
    "applicant": {
      "id": 10,
      "username": "zhangsan"
    },
    "createdAt": "2026-01-07T10:30:00Z"
  }
}
```

---

### 6.9 å–æ¶ˆç”³è¯·

**POST** `/api/development-applications/:id/cancel`

**é€‚ç”¨çŠ¶æ€ï¼š** `pending_info`ã€`awaiting_upload`

**è¯´æ˜ï¼š** å–æ¶ˆç”³è¯·åï¼Œç‰ˆæœ¬å·ä¼š**ç«‹å³é‡Šæ”¾**ï¼Œå¯è¢«å…¶ä»–ç”³è¯·ä½¿ç”¨ã€‚

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "ç”³è¯·å·²å–æ¶ˆ",
  "data": {
    "developmentStatus": "cancelled",
    "cancelledAt": "2026-01-07T15:00:00Z"
  }
}
```

**é”™è¯¯å“åº”ï¼ˆçŠ¶æ€ä¸å…è®¸å–æ¶ˆï¼‰ï¼š**

```json
{
  "code": 400,
  "message": "å½“å‰çŠ¶æ€ä¸å…è®¸å–æ¶ˆç”³è¯·",
  "error": {
    "currentStatus": "under_review",
    "allowedStatuses": ["pending_info", "awaiting_upload"]
  }
}
```

---

### 6.10 ç¼–è¾‘ç”³è¯·ä¿¡æ¯

**PATCH** `/api/development-applications/:id`

**é€‚ç”¨çŠ¶æ€ï¼š** `pending_info`ã€`awaiting_upload`

**è¯·æ±‚ä½“ï¼ˆéƒ¨åˆ†æ›´æ–°ï¼‰ï¼š**

```json
{
  "name": "æ•°æ®è¡¨æ ¼ç»„ä»¶",
  "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶ï¼Œæ”¯æŒè™šæ‹Ÿæ»šåŠ¨",
  "changelog": "åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€è¡¨æ ¼åŠŸèƒ½"
}
```

**å¯ç¼–è¾‘å­—æ®µï¼š**

| å­—æ®µ                   | æ–°ç»„ä»¶ | ç‰ˆæœ¬è¿­ä»£ | æ›¿æ¢ç‰ˆæœ¬ | è¯´æ˜               |
| ---------------------- | ------ | -------- | -------- | ------------------ |
| `name`                 | âœ…     | âŒ       | âŒ       | ä»…æ–°ç»„ä»¶å¯ä¿®æ”¹åç§° |
| `description`          | âœ…     | âœ…       | âœ…       | æ‰€æœ‰ç±»å‹å¯ä¿®æ”¹     |
| `classificationLevel1` | âœ…     | âŒ       | âŒ       | ä»…æ–°ç»„ä»¶å¯ä¿®æ”¹åˆ†ç±» |
| `classificationLevel2` | âœ…     | âŒ       | âŒ       | ä»…æ–°ç»„ä»¶å¯ä¿®æ”¹åˆ†ç±» |
| `changelog`            | âœ…     | âœ…       | âœ…       | æ‰€æœ‰ç±»å‹å¯ä¿®æ”¹     |

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "ç”³è¯·ä¿¡æ¯å·²æ›´æ–°",
  "data": {
    "id": 1,
    "applicationNo": "APP-20260107-0001",
    "name": "æ•°æ®è¡¨æ ¼ç»„ä»¶",
    "description": "é«˜æ€§èƒ½æ•°æ®è¡¨æ ¼ç»„ä»¶ï¼Œæ”¯æŒè™šæ‹Ÿæ»šåŠ¨",
    "changelog": "åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€è¡¨æ ¼åŠŸèƒ½",
    "updatedAt": "2026-01-07T11:30:00Z"
  }
}
```

**æ³¨æ„ï¼š** ç¼–è¾‘ç”³è¯·ä¿¡æ¯åï¼Œéœ€è¦é‡æ–°å¯¼å‡º `component.meta.supplement.json` æ–‡ä»¶ã€‚

---

## 7. æƒé™æ§åˆ¶

### 7.1 æƒé™å®šä¹‰

| æƒé™ä»£ç                                | æƒé™åç§°     | è¯´æ˜                               |
| -------------------------------------- | ------------ | ---------------------------------- |
| `development:application:create`       | åˆ›å»ºç ”å‘ç”³è¯· | å¼€å‘äººå‘˜æƒé™                       |
| `development:application:edit`         | ç¼–è¾‘ç”³è¯·ä¿¡æ¯ | ç”³è¯·äººæœ¬äºº                         |
| `development:application:upload`       | ä¸Šä¼ ç»„ä»¶åŒ…   | å¼€å‘äººå‘˜æƒé™                       |
| `development:application:submit`       | æäº¤å®¡æ ¸     | å¼€å‘äººå‘˜æƒé™                       |
| `development:application:review`       | å®¡æ ¸ç”³è¯·     | å®¡æ ¸äººå‘˜æƒé™                       |
| `development:application:self-approve` | è‡ªåŠ©å®¡æ‰¹     | ç®¡ç†å‘˜æƒé™ï¼Œå…è®¸å®¡æ‰¹è‡ªå·±åˆ›å»ºçš„ç”³è¯· |
| `development:application:view`         | æŸ¥çœ‹ç”³è¯·     | æ‰€æœ‰äºº                             |
| `development:application:cancel`       | å–æ¶ˆç”³è¯·     | ç”³è¯·äººæœ¬äºº                         |

### 7.2 è§’è‰²é…ç½®

**å¼€å‘äººå‘˜ï¼ˆDeveloperï¼‰ï¼š**

- âœ… åˆ›å»ºç ”å‘ç”³è¯·
- âœ… ç¼–è¾‘ç”³è¯·ä¿¡æ¯ï¼ˆæœ¬äººç”³è¯·ï¼‰
- âœ… ä¸Šä¼ ç»„ä»¶åŒ…
- âœ… æäº¤å®¡æ ¸
- âœ… å–æ¶ˆç”³è¯·ï¼ˆæœ¬äººç”³è¯·ï¼‰
- âœ… æŸ¥çœ‹è‡ªå·±çš„ç”³è¯·

**å®¡æ ¸äººå‘˜ï¼ˆReviewerï¼‰ï¼š**

- âœ… æŸ¥çœ‹æ‰€æœ‰ç”³è¯·
- âœ… å®¡æ ¸ç”³è¯·
- âœ… æŸ¥çœ‹å®¡æ ¸è®°å½•

**ç®¡ç†å‘˜ï¼ˆAdminï¼‰ï¼š**

- âœ… æ‰€æœ‰æƒé™
- âœ… è‡ªåŠ©å®¡æ‰¹ï¼ˆå¯å®¡æ‰¹è‡ªå·±åˆ›å»ºçš„ç”³è¯·ï¼Œç”¨äºå¿«é€Ÿä¸Šä¼ åœºæ™¯ï¼‰

---

## 8. ä¸šåŠ¡è§„åˆ™

### 8.1 ç‰ˆæœ¬å·è§„åˆ™

1. **ç‰ˆæœ¬å·æ ¼å¼ï¼š** éµå¾ª Semver è§„èŒƒï¼ˆå¦‚ï¼š1.0.0, 2.1.3ï¼‰
2. **æ–°ç»„ä»¶ï¼š** é»˜è®¤ç‰ˆæœ¬ 1.0.0
3. **ç‰ˆæœ¬è¿­ä»£ï¼š** æ–°ç‰ˆæœ¬å·å¿…é¡»å¤§äºç°æœ‰æœ€é«˜ç‰ˆæœ¬
4. **ç‰ˆæœ¬å”¯ä¸€æ€§ï¼š** åŒä¸€ç»„ä»¶ä¸èƒ½æœ‰é‡å¤ç‰ˆæœ¬å·
5. **ç‰ˆæœ¬å·å ç”¨ä¸é‡Šæ”¾ï¼š**
   - âœ… åˆ›å»ºç”³è¯·æ—¶å ç”¨ç‰ˆæœ¬å·ï¼ˆé˜²æ­¢å†²çªï¼‰
   - âœ… ç”³è¯·çŠ¶æ€ä¸º `cancelled` æ—¶**è‡ªåŠ¨é‡Šæ”¾ç‰ˆæœ¬å·**
   - âœ… é‡Šæ”¾åè¯¥ç‰ˆæœ¬å·å¯è¢«å…¶ä»–ç”³è¯·ä½¿ç”¨
   - ğŸ“‹ **ä¸šåŠ¡é—­ç¯è§„åˆ™ï¼š**
     - `pending_info` â†’ `cancelled`ï¼šé‡Šæ”¾ç‰ˆæœ¬å·
     - `awaiting_upload` â†’ `cancelled`ï¼šé‡Šæ”¾ç‰ˆæœ¬å·
     - å…¶ä»–çŠ¶æ€ä¸å…è®¸å–æ¶ˆï¼Œç‰ˆæœ¬å·ä¿æŒå ç”¨
   - ğŸ” **ç‰ˆæœ¬å·æ ¡éªŒé€»è¾‘ï¼š**
     ```typescript
     // æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦å¯ç”¨
     const existingApplication = await this.findOne({
       componentId,
       targetVersion,
       developmentStatus: Not(In(['cancelled'])) // æ’é™¤å·²å–æ¶ˆçš„ç”³è¯·
     })
     if (existingApplication) {
       throw new Error('ç‰ˆæœ¬å·å·²è¢«å ç”¨')
     }
     ```

### 8.2 ä¸Šä¼ å…¥å£ç»Ÿä¸€è§„åˆ™

**å”¯ä¸€ä¸Šä¼ å…¥å£ï¼š** `POST /api/development-applications/:id/upload`

**åºŸå¼ƒæ¥å£ï¼š** `POST /api/components/upload`ï¼ˆæ ‡è®°ä¸º `@Deprecated`ï¼Œä¸‹ç‰ˆæœ¬ç§»é™¤ï¼‰

**åŸå› ï¼š**

1. **åˆ†ç±»ä¿¡æ¯è§„èŒƒåŒ–**ï¼šåˆ†ç±»ä¿¡æ¯ç”±ç³»ç»Ÿç®¡ç†ï¼Œä¸å…è®¸å¼€å‘è€…è‡ªè¡Œå¡«å†™
2. **æµç¨‹è§„èŒƒåŒ–**ï¼šæ‰€æœ‰ç»„ä»¶ä¸Šä¼ éƒ½éœ€è¦ç»è¿‡ç”³è¯·-å®¡æ‰¹æµç¨‹
3. **å¯è¿½æº¯æ€§**ï¼šæ¯æ¬¡ä¸Šä¼ éƒ½æœ‰å¯¹åº”çš„ç”³è¯·è®°å½•ï¼Œä¾¿äºå®¡è®¡

**ç®¡ç†å‘˜å¿«é€Ÿä¸Šä¼ æµç¨‹ï¼š**

```mermaid
flowchart LR
    A[åˆ›å»ºç”³è¯·] --> B[å¯¼å‡º supplement]
    B --> C[æ„å»ºç»„ä»¶åŒ…]
    C --> D[ä¸Šä¼ æ–‡ä»¶]
    D --> E[è‡ªåŠ©å®¡æ‰¹]
    E --> F[ç‰ˆæœ¬åˆ›å»º]
```

**è‡ªåŠ©å®¡æ‰¹è§„åˆ™ï¼š**

- ä»…ç®¡ç†å‘˜æ‹¥æœ‰ `development:application:self-approve` æƒé™
- è‡ªåŠ©å®¡æ‰¹ä¼šè®°å½•å®¡æ ¸äºº = ç”³è¯·äººï¼Œä¾¿äºè¿½æº¯
- å®¡æ ¸æ„è§è‡ªåŠ¨å¡«å……ä¸º"ç®¡ç†å‘˜è‡ªåŠ©å®¡æ‰¹"

### 8.3 æ–‡ä»¶ä¸Šä¼ è§„åˆ™

1. **æ–‡ä»¶ç±»å‹ï¼š** ä»…æ”¯æŒ .zip æ ¼å¼
2. **æ–‡ä»¶å¤§å°ï¼š** æœ€å¤§ 50MB
3. **å¿…éœ€æ–‡ä»¶ï¼š**
   - `component.meta.supplement.json`ï¼ˆç”³è¯·ç³»ç»Ÿå¯¼å‡ºï¼‰
   - `component.meta.json`ï¼ˆabd-cli ç”Ÿæˆï¼‰
   - ä¸»å…¥å£æ–‡ä»¶ï¼ˆå¦‚ï¼š`index.esm.js`ï¼‰
4. **éªŒè¯è§„åˆ™ï¼š**
   - âœ… `component.meta.supplement.json` å¿…é¡»å­˜åœ¨
   - âœ… `component.meta.json` å¿…é¡»å­˜åœ¨
   - âœ… supplement æ–‡ä»¶çš„ `id` å¿…é¡»ä¸ç”³è¯·çš„ `componentId` ä¸€è‡´
   - âœ… supplement æ–‡ä»¶çš„ `name` å¿…é¡»ä¸ç”³è¯·çš„ `name` ä¸€è‡´
   - âœ… supplement æ–‡ä»¶çš„ `version` å¿…é¡»ä¸ç”³è¯·çš„ `targetVersion` ä¸€è‡´
   - âœ… supplement æ–‡ä»¶çš„åˆ†ç±»ä¿¡æ¯å¿…é¡»ä¸ç”³è¯·ä¸€è‡´
   - âœ… meta æ–‡ä»¶ä¸­å£°æ˜çš„æ–‡ä»¶å¿…é¡»å­˜åœ¨äº zip åŒ…ä¸­
5. **å®‰å…¨è§„åˆ™ï¼š**
   - ğŸ”’ **é˜¶æ®µ1ï¼ˆå½“å‰ï¼‰**ï¼šä¸Šä¼ æ—¶é€å­—æ®µæ ¡éªŒ supplement æ–‡ä»¶ä¸ç”³è¯·ä¿¡æ¯ä¸€è‡´
     - é˜²æ­¢ä¸Šä¼ é”™è¯¯çš„æ–‡ä»¶ï¼ˆå¤šä¸ªç”³è¯·æ—¶ï¼‰
     - é˜²æ­¢æ‰‹åŠ¨ç¯¡æ”¹æ–‡ä»¶å†…å®¹
   - ğŸ”’ **é˜¶æ®µ2ï¼ˆç­¾åæœºåˆ¶ï¼‰**ï¼šsupplement æ–‡ä»¶åŒ…å«æ•°å­—ç­¾å
     - åªéœ€éªŒè¯ç­¾åæœ‰æ•ˆæ€§å’Œç”³è¯·IDåŒ¹é…
     - æ— éœ€é€å­—æ®µå¯¹æ¯”ï¼Œç®€åŒ–æ ¡éªŒæµç¨‹
     - å®ç°æ–¹å¼ï¼šHMAC-SHA256 ç­¾åç®—æ³•

### 8.4 ç‰ˆæœ¬æ›¿æ¢è§„åˆ™

1. **å¯æ›¿æ¢æ¡ä»¶ï¼š**
   - âœ… ç‰ˆæœ¬çŠ¶æ€å¿…é¡»ä¸º `draft`
   - âœ… å¿…é¡»é€šè¿‡ç ”å‘ç”³è¯·æµç¨‹
   - âœ… éœ€è¦ä½¿ç”¨ç›¸åŒçš„ç‰ˆæœ¬å·
2. **ä¸å¯æ›¿æ¢æ¡ä»¶ï¼š**
   - âŒ `published` çŠ¶æ€çš„ç‰ˆæœ¬ä¸å¯æ›¿æ¢
   - âŒ å·²åˆ é™¤çš„ç‰ˆæœ¬ä¸å¯æ›¿æ¢
3. **æ›¿æ¢æµç¨‹ï¼š**
   - åˆ›å»ºç±»å‹ä¸º `replace` çš„ç ”å‘ç”³è¯·
   - å…³è”ç°æœ‰çš„ draft ç‰ˆæœ¬ID
   - ä¸Šä¼ æ–°çš„ç»„ä»¶åŒ…
   - å®¡æ ¸é€šè¿‡åæ›´æ–°ç°æœ‰ç‰ˆæœ¬è®°å½•
4. **æ•°æ®ä¿ç•™ï¼š**
   - ä¿ç•™åŸç‰ˆæœ¬çš„åˆ›å»ºæ—¶é—´
   - æ›´æ–°ä¿®æ”¹æ—¶é—´å’Œä¿®æ”¹äºº
   - ä¿ç•™ç‰ˆæœ¬IDä¸å˜

### 8.5 çŠ¶æ€æµè½¬è§„åˆ™

| å½“å‰çŠ¶æ€          | å¯æµè½¬çŠ¶æ€        | è§¦å‘æ¡ä»¶     | ç‰ˆæœ¬å·çŠ¶æ€         |
| ----------------- | ----------------- | ------------ | ------------------ |
| `pending_info`    | `awaiting_upload` | ä¿¡æ¯å®Œå–„     | ä¿æŒå ç”¨           |
| `pending_info`    | `cancelled`       | å–æ¶ˆç”³è¯·     | **é‡Šæ”¾ç‰ˆæœ¬å·** âœ…  |
| `awaiting_upload` | `uploaded`        | ä¸Šä¼ æ–‡ä»¶æˆåŠŸ | ä¿æŒå ç”¨           |
| `awaiting_upload` | `cancelled`       | å–æ¶ˆç”³è¯·     | **é‡Šæ”¾ç‰ˆæœ¬å·** âœ…  |
| `uploaded`        | `awaiting_upload` | åˆ é™¤ä¸Šä¼ åŒ…   | ä¿æŒå ç”¨           |
| `uploaded`        | `under_review`    | æäº¤å®¡æ ¸     | ä¿æŒå ç”¨           |
| `under_review`    | `approved`        | å®¡æ ¸é€šè¿‡     | ä¿æŒå ç”¨           |
| `under_review`    | `rejected`        | å®¡æ ¸ä¸é€šè¿‡   | ä¿æŒå ç”¨           |
| `rejected`        | `awaiting_upload` | è‡ªåŠ¨å›é€€     | ä¿æŒå ç”¨           |
| `approved`        | `completed`       | ç‰ˆæœ¬å‘å¸ƒ     | ä¿æŒå ç”¨ï¼ˆå·²åˆ›å»ºï¼‰ |

### 8.6 åˆ é™¤è§„åˆ™

| çŠ¶æ€              | æ˜¯å¦å¯åˆ é™¤ä¸Šä¼ åŒ… | æ˜¯å¦å¯å–æ¶ˆç”³è¯· |
| ----------------- | ---------------- | -------------- |
| `pending_info`    | N/A              | âœ…             |
| `awaiting_upload` | N/A              | âœ…             |
| `uploaded`        | âœ…               | âŒ             |
| `under_review`    | âŒ               | âŒ             |
| `rejected`        | âŒ               | âŒ             |
| `approved`        | âŒ               | âŒ             |
| `completed`       | âŒ               | âŒ             |

### 8.7 å–æ¶ˆç”³è¯·ä¸ç‰ˆæœ¬å·é‡Šæ”¾

**å¯å–æ¶ˆçš„çŠ¶æ€ï¼š**

- âœ… `pending_info`ï¼šä¿¡æ¯å°šæœªå®Œå–„ï¼Œå¯ä»¥å–æ¶ˆ
- âœ… `awaiting_upload`ï¼šå°šæœªä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥å–æ¶ˆ

**ä¸å¯å–æ¶ˆçš„çŠ¶æ€ï¼š**

- âŒ `uploaded`ï¼šå·²ä¸Šä¼ æ–‡ä»¶ï¼Œéœ€é€šè¿‡åˆ é™¤ä¸Šä¼ åŒ…å›é€€
- âŒ `under_review`ï¼šæ­£åœ¨å®¡æ ¸ä¸­ï¼Œä¸å¯å–æ¶ˆ
- âŒ `rejected`ï¼šå·²è¢«æ‹’ç»ï¼Œä¼šè‡ªåŠ¨å›åˆ° `awaiting_upload`
- âŒ `approved`ï¼šå·²å®¡æ ¸é€šè¿‡ï¼Œä¸å¯å–æ¶ˆ
- âŒ `completed`ï¼šå·²å®Œæˆï¼Œä¸å¯å–æ¶ˆ

**ç‰ˆæœ¬å·é‡Šæ”¾æœºåˆ¶ï¼š**

```typescript
// å–æ¶ˆç”³è¯·çš„ä¸šåŠ¡é€»è¾‘
async cancelApplication(id: number) {
  const application = await this.findOne(id);

  // 1. æ£€æŸ¥æ˜¯å¦å¯å–æ¶ˆ
  const cancellableStatuses = ['pending_info', 'awaiting_upload'];
  if (!cancellableStatuses.includes(application.developmentStatus)) {
    throw new Error('å½“å‰çŠ¶æ€ä¸å…è®¸å–æ¶ˆç”³è¯·');
  }

  // 2. æ›´æ–°çŠ¶æ€ä¸º cancelled
  application.developmentStatus = 'cancelled';
  await this.save(application);

  // 3. ç‰ˆæœ¬å·è‡ªåŠ¨é‡Šæ”¾ï¼Œå…¶ä»–ç”³è¯·å¯ä½¿ç”¨è¯¥ç‰ˆæœ¬å·
  // ï¼ˆæ— éœ€é¢å¤–æ“ä½œï¼ŒæŸ¥è¯¢æ—¶æ’é™¤ cancelled çŠ¶æ€å³å¯ï¼‰

  return application;
}
```

**ä¸šåŠ¡é—­ç¯ä¿è¯ï¼š**

1. **åˆ›å»ºç”³è¯·æ—¶æ£€æŸ¥ç‰ˆæœ¬å·ï¼š**

   ```sql
   SELECT * FROM development_applications
   WHERE component_id = 'DataTable'
     AND target_version = '1.0.0'
     AND development_status != 'cancelled'; -- æ’é™¤å·²å–æ¶ˆ
   ```

2. **å–æ¶ˆåç‰ˆæœ¬å·ç«‹å³å¯ç”¨ï¼š**
   - ç”³è¯·Aï¼šDataTable v1.0.0ï¼ŒçŠ¶æ€ `awaiting_upload`
   - æ“ä½œï¼šå–æ¶ˆç”³è¯·A â†’ çŠ¶æ€å˜ä¸º `cancelled`
   - ç»“æœï¼šå¯ä»¥ç«‹å³åˆ›å»ºç”³è¯·Bä½¿ç”¨ DataTable v1.0.0

3. **æœ€ç»ˆçŠ¶æ€åªæœ‰ä¸¤ç§ï¼š**
   - âœ… `completed`ï¼šç‰ˆæœ¬å·²å‘å¸ƒï¼Œç‰ˆæœ¬å·æ°¸ä¹…å ç”¨
   - âœ… `cancelled`ï¼šç”³è¯·å·²å–æ¶ˆï¼Œç‰ˆæœ¬å·å·²é‡Šæ”¾

**APIæ¥å£ï¼š**

```typescript
// POST /api/development-applications/:id/cancel
{
  "code": 200,
  "message": "ç”³è¯·å·²å–æ¶ˆï¼Œç‰ˆæœ¬å·å·²é‡Šæ”¾",
  "data": {
    "applicationNo": "APP-20260107-0001",
    "developmentStatus": "cancelled",
    "releasedVersion": "1.0.0",
    "cancelledAt": "2026-01-07T15:30:00Z"
  }
}
```

---

## 9. æ‰©å±•è€ƒè™‘

### 9.1 é€šçŸ¥æœºåˆ¶

- âœ‰ï¸ æäº¤å®¡æ ¸æ—¶é€šçŸ¥å®¡æ ¸äººå‘˜
- âœ‰ï¸ å®¡æ ¸å®Œæˆæ—¶é€šçŸ¥ç”³è¯·äºº
- âœ‰ï¸ ç‰ˆæœ¬å‘å¸ƒæ—¶é€šçŸ¥ç›¸å…³äººå‘˜

### 9.2 å®¡æ‰¹æµç¨‹æ‰©å±•

- å¤šçº§å®¡æ‰¹ï¼ˆæŠ€æœ¯å®¡æ‰¹ â†’ äº§å“å®¡æ‰¹ï¼‰
- å®¡æ‰¹å§”æ‰˜
- æ‰¹é‡å®¡æ‰¹

### 9.3 ç»Ÿè®¡åˆ†æ

- ç ”å‘ç”³è¯·æ•°é‡ç»Ÿè®¡
- å®¡æ ¸é€šè¿‡ç‡åˆ†æ
- å¹³å‡å®¡æ ¸æ—¶é•¿
- ç»„ä»¶å‘å¸ƒè¶‹åŠ¿

---

## 10. æ—¶åºå›¾

### 10.1 å®Œæ•´æµç¨‹æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯
    participant A as APIæœåŠ¡
    participant D as æ•°æ®åº“
    participant O as OSSå­˜å‚¨
    participant R as å®¡æ ¸äººå‘˜

    Note over U,R: 1. åˆ›å»ºç ”å‘ç”³è¯·
    U->>F: å¡«å†™ç”³è¯·ä¿¡æ¯
    F->>A: POST /development-applications
    A->>D: åˆ›å»ºç”³è¯·è®°å½•
    A->>A: ç”Ÿæˆç”³è¯·å•å·
    D-->>A: è¿”å›ç”³è¯·ID
    A-->>F: ç”³è¯·åˆ›å»ºæˆåŠŸ
    F-->>U: æ˜¾ç¤ºç”³è¯·è¯¦æƒ…

    Note over U,R: 2. ä¸Šä¼ ç»„ä»¶åŒ…
    U->>F: é€‰æ‹© .zip æ–‡ä»¶
    F->>A: POST /applications/:id/upload
    A->>A: éªŒè¯æ–‡ä»¶æ ¼å¼å’Œå¤§å°
    A->>O: ä¸Šä¼ åˆ°ä¸´æ—¶å­˜å‚¨
    O-->>A: è¿”å›ä¸´æ—¶è·¯å¾„
    A->>A: è§£å‹å¹¶éªŒè¯ meta.json
    A->>D: æ›´æ–°ä¸Šä¼ ä¿¡æ¯
    A-->>F: ä¸Šä¼ æˆåŠŸ
    F-->>U: æ˜¾ç¤ºä¸Šä¼ ç»“æœ

    Note over U,R: 3. æäº¤å®¡æ ¸
    U->>F: ç‚¹å‡»æäº¤å®¡æ ¸
    F->>A: POST /applications/:id/submit-review
    A->>D: æ›´æ–°çŠ¶æ€ä¸º under_review
    A->>A: å‘é€é€šçŸ¥ç»™å®¡æ ¸äººå‘˜
    A-->>F: æäº¤æˆåŠŸ
    F-->>U: ç­‰å¾…å®¡æ ¸

    Note over U,R: 4. å®¡æ ¸æµç¨‹
    R->>F: æŸ¥çœ‹å¾…å®¡æ ¸ç”³è¯·
    F->>A: GET /applications?status=under_review
    A->>D: æŸ¥è¯¢ç”³è¯·åˆ—è¡¨
    D-->>A: è¿”å›ç”³è¯·æ•°æ®
    A-->>F: è¿”å›åˆ—è¡¨
    F-->>R: æ˜¾ç¤ºç”³è¯·è¯¦æƒ…

    R->>F: æ‰§è¡Œå®¡æ ¸æ“ä½œ
    F->>A: POST /applications/:id/review

    alt å®¡æ ¸é€šè¿‡
        A->>O: ç§»åŠ¨æ–‡ä»¶åˆ°æ­£å¼è·¯å¾„
        O-->>A: ç§»åŠ¨æˆåŠŸ
        A->>D: åˆ›å»º ComponentVersion
        A->>D: æ›´æ–°ç”³è¯·çŠ¶æ€ä¸º approved
        A->>A: å‘é€é€šçŸ¥ç»™ç”³è¯·äºº
        A-->>F: å®¡æ ¸é€šè¿‡
        F-->>R: æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        A->>U: é€šçŸ¥å®¡æ ¸é€šè¿‡
    else å®¡æ ¸ä¸é€šè¿‡
        A->>O: åˆ é™¤ä¸´æ—¶æ–‡ä»¶
        A->>D: æ›´æ–°çŠ¶æ€ä¸º rejected
        A->>A: å‘é€é€šçŸ¥ç»™ç”³è¯·äºº
        A-->>F: å®¡æ ¸ä¸é€šè¿‡
        F-->>R: æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        A->>U: é€šçŸ¥å®¡æ ¸ä¸é€šè¿‡
    end
```

---

## 11. å®ç°å»ºè®®

### 11.1 åˆ†é˜¶æ®µå®æ–½

**é˜¶æ®µ1ï¼šåŸºç¡€åŠŸèƒ½ï¼ˆMVPï¼‰**

- âœ… åˆ›å»ºç ”å‘ç”³è¯·
- âœ… ä¸Šä¼ ç»„ä»¶åŒ…
- âœ… åŸºç¡€å®¡æ ¸æµç¨‹
- âœ… çŠ¶æ€æµè½¬

**é˜¶æ®µ2ï¼šå¢å¼ºåŠŸèƒ½**

- âœ… é€šçŸ¥æœºåˆ¶
- âœ… å®¡æ ¸æ„è§åé¦ˆ
- âœ… æ–‡ä»¶æ›¿æ¢åŠŸèƒ½

**é˜¶æ®µ3ï¼šé«˜çº§åŠŸèƒ½**

- âœ… å¤šçº§å®¡æ‰¹
- âœ… ç»Ÿè®¡åˆ†æ
- âœ… å®¡æ‰¹æµç¨‹å¯é…ç½®

### 11.2 æŠ€æœ¯æ ˆå»ºè®®

- **åç«¯æ¡†æ¶ï¼š** NestJSï¼ˆå·²æœ‰ï¼‰
- **æ•°æ®åº“ï¼š** MySQL + TypeORMï¼ˆå·²æœ‰ï¼‰
- **æ–‡ä»¶å­˜å‚¨ï¼š** OSSï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
- **æ¶ˆæ¯é€šçŸ¥ï¼š** WebSocket / Server-Sent Events
- **ä»»åŠ¡é˜Ÿåˆ—ï¼š** Bullï¼ˆæ–‡ä»¶å¤„ç†ï¼‰

---

## 12. FAQ

### Q1: ä¸ºä»€ä¹ˆéœ€è¦"ç ”å‘ç”³è¯·"è€Œä¸æ˜¯ç›´æ¥ä¸Šä¼ ï¼Ÿ

**A:** ç ”å‘ç”³è¯·æµç¨‹å¯ä»¥ï¼š

- æå‰è§„åˆ’ç‰ˆæœ¬å’ŒåŠŸèƒ½
- é¿å…ç‰ˆæœ¬å·å†²çª
- å»ºç«‹å®¡æ‰¹å’Œè´¨é‡æŠŠæ§æœºåˆ¶
- æä¾›å¯è¿½æº¯çš„ç ”å‘è®°å½•

### Q2: å®¡æ ¸ä¸é€šè¿‡åï¼Œæ˜¯å¦éœ€è¦é‡æ–°åˆ›å»ºç”³è¯·ï¼Ÿ

**A:** ä¸éœ€è¦ï¼Œç”³è¯·çŠ¶æ€ä¼šå›åˆ° `awaiting_upload`ï¼Œç”¨æˆ·å¯ä»¥ä¿®å¤é—®é¢˜åé‡æ–°ä¸Šä¼ ã€‚

### Q3: å·²ä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥è¢«æ›¿æ¢å—ï¼Ÿ

**A:**

- âœ… `uploaded` çŠ¶æ€ï¼šå¯ä»¥åˆ é™¤åé‡æ–°ä¸Šä¼ 
- âŒ `under_review` çŠ¶æ€ï¼šä¸å¯åˆ é™¤æˆ–æ›¿æ¢
- âŒ `approved` çŠ¶æ€ï¼šä¸å¯åˆ é™¤æˆ–æ›¿æ¢

### Q4: ä¸€ä¸ªç»„ä»¶å¯ä»¥åŒæ—¶æœ‰å¤šä¸ªç ”å‘ç”³è¯·å—ï¼Ÿ

**A:** å¯ä»¥ï¼Œä½†åŒä¸€ä¸ªç‰ˆæœ¬å·åªèƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆç”³è¯·ã€‚

### Q5: ä¸ºä»€ä¹ˆè¦å°† component.meta.json æ‹†åˆ†æˆä¸¤ä¸ªæ–‡ä»¶ï¼Ÿ

**A:**

- **èŒè´£åˆ†ç¦»**ï¼šsupplement æ–‡ä»¶ç”±ç”³è¯·ç³»ç»Ÿç®¡ç†ï¼ˆåŸºæœ¬ä¿¡æ¯ï¼‰ï¼Œmeta æ–‡ä»¶ç”±æ„å»ºå·¥å…·ç”Ÿæˆï¼ˆæŠ€æœ¯ä¿¡æ¯ï¼‰
- **é˜²æ­¢ç¯¡æ”¹**ï¼šsupplement æ–‡ä»¶å¯ä»¥åŠ å¯†ç­¾åï¼Œç¡®ä¿ç”¨æˆ·ä¸èƒ½éšæ„ä¿®æ”¹ç»„ä»¶æ ‡è¯†å’Œåˆ†ç±»
- **æµç¨‹è§„èŒƒ**ï¼šç¡®ä¿ç»„ä»¶ä¿¡æ¯ä¸ç ”å‘ç”³è¯·ä¸€è‡´ï¼Œé¿å…ä¸Šä¼ æ—¶ä¿¡æ¯ä¸åŒ¹é…
- **ç‰ˆæœ¬è¿½æº¯**ï¼šsupplement æ–‡ä»¶è®°å½•äº†ç”³è¯·æ¥æºï¼Œä¾¿äºè¿½æº¯

### Q6: ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥æ›¿æ¢å·²æœ‰ç‰ˆæœ¬ï¼Ÿ

**A:**

- âœ… **å¯ä»¥æ›¿æ¢**ï¼šç‰ˆæœ¬çŠ¶æ€ä¸º `draft`ï¼ˆè‰ç¨¿ï¼‰
- âŒ **ä¸èƒ½æ›¿æ¢**ï¼šç‰ˆæœ¬çŠ¶æ€ä¸º `published`ï¼ˆå·²å‘å¸ƒï¼‰
- **åŸå› **ï¼šdraft ç‰ˆæœ¬å°šæœªå¯¹å¤–å‘å¸ƒï¼Œå¯ä»¥ä¿®æ”¹ï¼›published ç‰ˆæœ¬å·²è¢«ä½¿ç”¨ï¼Œä¸èƒ½ä¿®æ”¹ä»¥ä¿è¯ç¨³å®šæ€§

### Q7: æ›¿æ¢ç‰ˆæœ¬å’Œåˆ›å»ºæ–°ç‰ˆæœ¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A:**

| é¡¹ç›®         | åˆ›å»ºæ–°ç‰ˆæœ¬                     | æ›¿æ¢ç‰ˆæœ¬                       |
| ------------ | ------------------------------ | ------------------------------ |
| **ç‰ˆæœ¬å·**   | å¿…é¡»æ˜¯æ–°çš„ç‰ˆæœ¬å·               | ä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·                 |
| **ç”³è¯·ç±»å‹** | `version`                      | `replace`                      |
| **ç›®æ ‡æ“ä½œ** | åˆ›å»ºæ–°çš„ ComponentVersion è®°å½• | æ›´æ–°ç°æœ‰ ComponentVersion è®°å½• |
| **ä½¿ç”¨åœºæ™¯** | åŠŸèƒ½è¿­ä»£ã€æ–°ç‰¹æ€§               | ä¿®å¤ bugã€ä¼˜åŒ–æ€§èƒ½             |
| **æ–‡ä»¶å¯¼å‡º** | å¯¼å‡º supplement æ–‡ä»¶           | å¯¼å‡ºå®Œæ•´ meta ä¿¡æ¯             |

### Q8: å¦‚æœå¿˜è®°å°† component.meta.supplement.json æ”¾å…¥ç»„ä»¶åŒ…ä¼šæ€æ ·ï¼Ÿ

**A:** ä¸Šä¼ æ—¶ä¼šéªŒè¯å¤±è´¥ï¼Œæç¤º"ç¼ºå°‘å¿…éœ€æ–‡ä»¶ï¼šcomponent.meta.supplement.json"ã€‚å¿…é¡»é‡æ–°æ‰“åŒ…ä¸Šä¼ ã€‚

### Q9: å–æ¶ˆç”³è¯·åï¼Œç‰ˆæœ¬å·å¯ä»¥ç«‹å³è¢«å…¶ä»–ç”³è¯·ä½¿ç”¨å—ï¼Ÿ

**A:** æ˜¯çš„ï¼Œå–æ¶ˆç”³è¯·åç‰ˆæœ¬å·ä¼š**ç«‹å³é‡Šæ”¾**ã€‚

- âœ… ç”³è¯·Aä½¿ç”¨ DataTable v1.0.0ï¼ŒçŠ¶æ€ä¸º `awaiting_upload`
- âœ… å–æ¶ˆç”³è¯·A â†’ çŠ¶æ€å˜ä¸º `cancelled`
- âœ… ç«‹å³å¯ä»¥åˆ›å»ºç”³è¯·Bä½¿ç”¨ DataTable v1.0.0
- ğŸ”’ ç³»ç»ŸæŸ¥è¯¢æ—¶ä¼šæ’é™¤ `cancelled` çŠ¶æ€çš„ç”³è¯·

### Q10: OSS æ–‡ä»¶è¿ç§»æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ

**A:** ä½¿ç”¨ **OSS æœåŠ¡ç«¯å¤åˆ¶**ï¼ˆServer-Side Copyï¼‰æŠ€æœ¯ï¼š

- ğŸ”§ **æŠ€æœ¯æ–¹æ¡ˆ**ï¼šè°ƒç”¨ OSS CopyObject API
- âœ… **ä¼˜åŠ¿**ï¼š
  - ä¸éœ€è¦ä¸‹è½½æ–‡ä»¶åˆ°åº”ç”¨æœåŠ¡å™¨
  - ä¸éœ€è¦é‡æ–°ä¸Šä¼ æ–‡ä»¶
  - èŠ‚çœå¸¦å®½å’Œæ—¶é—´
  - ä¿è¯æ–‡ä»¶å®Œæ•´æ€§
- ğŸ“‹ **æµç¨‹**ï¼š
  1. å®¡æ ¸é€šè¿‡åï¼Œè°ƒç”¨ OSS CopyObject
  2. ä» `temp/APP-20260107-0001/` å¤åˆ¶åˆ° `components/DataTable/1.0.0/`
  3. å¤åˆ¶æˆåŠŸååˆ é™¤ä¸´æ—¶æ–‡ä»¶
  4. æ‰€æœ‰æ“ä½œåœ¨ OSS æœåŠ¡ç«¯å®Œæˆ

### Q11: å“ªäº›çŠ¶æ€æ˜¯æœ€ç»ˆçŠ¶æ€ï¼ˆä¸å¯å†å˜æ›´ï¼‰ï¼Ÿ

**A:** ä¸¤ä¸ªæœ€ç»ˆçŠ¶æ€ï¼š

- âœ… `completed`ï¼šç‰ˆæœ¬å·²å‘å¸ƒï¼Œæµç¨‹æ­£å¸¸ç»“æŸ
- âœ… `cancelled`ï¼šç”³è¯·å·²å–æ¶ˆï¼Œæµç¨‹æå‰ç»“æŸ

è¿™ä¸¤ä¸ªçŠ¶æ€éƒ½ä¸å¯å†å˜æ›´ï¼Œå½¢æˆä¸šåŠ¡é—­ç¯ã€‚

### Q12: ä¸ºä»€ä¹ˆ supplement æ–‡ä»¶å·²ç»æ˜¯ç³»ç»Ÿå¯¼å‡ºçš„ï¼Œä¸Šä¼ æ—¶è¿˜è¦æ ¡éªŒï¼Ÿ

**A:** å‡ºäºå®‰å…¨å’Œé˜²é”™è€ƒè™‘ï¼Œä»éœ€æ ¡éªŒï¼š

**éœ€è¦æ ¡éªŒçš„åŸå› ï¼š**

- ğŸ”´ **é˜²æ­¢é”™ä¼ **ï¼šç”¨æˆ·å¯èƒ½åŒæ—¶æœ‰å¤šä¸ªç”³è¯·ï¼Œä¸‹è½½äº†ç”³è¯·Açš„æ–‡ä»¶å´ä¸Šä¼ åˆ°ç”³è¯·B
- ğŸ”´ **é˜²æ­¢ç¯¡æ”¹**ï¼šå½“å‰é˜¶æ®µç­¾åæœºåˆ¶æœªå®ç°ï¼Œç”¨æˆ·å¯èƒ½æ‰‹åŠ¨ä¿®æ”¹æ–‡ä»¶
- ğŸ”´ **ä¿¡æ¯å˜æ›´**ï¼šç”¨æˆ·å¯èƒ½åœ¨å¯¼å‡ºæ–‡ä»¶åä¿®æ”¹äº†ç”³è¯·ä¿¡æ¯ï¼Œéœ€ç¡®ä¿ä¸€è‡´æ€§

**ä¼˜åŒ–æ–¹æ¡ˆï¼ˆé˜¶æ®µ2ï¼‰ï¼š**

å®ç°æ•°å­—ç­¾åæœºåˆ¶åï¼Œå¯ç®€åŒ–æ ¡éªŒï¼š

```json
{
  "id": "DataTable",
  "name": "æ•°æ®è¡¨æ ¼",
  "version": "1.0.0",
  "classification": { ... },
  "_metadata": {
    "applicationId": 1,
    "applicationNo": "APP-20260107-0001",
    "signature": "SHA256_HMAC_SIGNATURE"
  }
}
```

**ç®€åŒ–åçš„æ ¡éªŒæµç¨‹ï¼š**

- âœ… åŸºç¡€æ ¼å¼éªŒè¯ï¼ˆJSONã€å¿…éœ€å­—æ®µï¼‰
- âœ… ç­¾åæœ‰æ•ˆæ€§éªŒè¯ï¼ˆé˜²ç¯¡æ”¹ï¼‰
- âœ… applicationId åŒ¹é…éªŒè¯ï¼ˆé˜²é”™ä¼ ï¼‰
- âŒ çœç•¥é€å­—æ®µå¯¹æ¯”ï¼ˆidã€nameã€versionã€classificationï¼‰

**åŸç†ï¼š** ç­¾åæœ‰æ•ˆ = å†…å®¹æœªè¢«ä¿®æ”¹ = ä¸ç”³è¯·åˆ›å»ºæ—¶ä¸€è‡´

**æ€§èƒ½æå‡ï¼š** ä» O(n) å­—æ®µå¯¹æ¯”ç®€åŒ–ä¸º O(1) ç­¾åéªŒè¯

---

## ğŸ“Œ æ€»ç»“

æœ¬è®¾è®¡æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„ç»„ä»¶ç ”å‘ç”³è¯·æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

âœ… **æ¸…æ™°çš„çŠ¶æ€æµè½¬** - 8 ä¸ªçŠ¶æ€è¦†ç›–å…¨æµç¨‹  
âœ… **çµæ´»çš„æ–‡ä»¶ç®¡ç†** - æ”¯æŒä¸Šä¼ ã€åˆ é™¤ã€æ›¿æ¢  
âœ… **è§„èŒƒçš„å®¡æ‰¹æœºåˆ¶** - å®¡æ ¸é€šè¿‡/ä¸é€šè¿‡çš„å®Œæ•´æµç¨‹  
âœ… **æ‰©å±•æ€§è®¾è®¡** - æ”¯æŒå¤šçº§å®¡æ‰¹ã€é€šçŸ¥ã€ç»Ÿè®¡ç­‰æ‰©å±•  
âœ… **æƒé™æ§åˆ¶** - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶  
âœ… **API å®Œæ•´æ€§** - 10 ä¸ªæ¥å£è¦†ç›–å…¨éƒ¨ä¸šåŠ¡åœºæ™¯  
âœ… **ç»Ÿä¸€ä¸Šä¼ å…¥å£** - åºŸå¼ƒç›´æ¥ä¸Šä¼ ï¼Œæ‰€æœ‰ç»„ä»¶é€šè¿‡ç”³è¯·æµç¨‹ä¸Šä¼ 

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.2  
**åˆ›å»ºæ—¥æœŸï¼š** 2026-01-07  
**æ›´æ–°æ—¥æœŸï¼š** 2026-01-07  
**ä½œè€…ï¼š** GitHub Copilot

**v1.2 æ›´æ–°å†…å®¹ï¼š**

- æ–°å¢ 1.3 é‡è¦å†³ç­–ï¼šåºŸå¼ƒç›´æ¥ä¸Šä¼ æ¥å£
- æ–°å¢ 8.2 ä¸Šä¼ å…¥å£ç»Ÿä¸€è§„åˆ™
- æ–°å¢ `development:application:self-approve` è‡ªåŠ©å®¡æ‰¹æƒé™
- æ›´æ–°ç®¡ç†å‘˜è§’è‰²æƒé™è¯´æ˜
- è°ƒæ•´ç« èŠ‚ç¼–å·ï¼ˆ8.3-8.7ï¼‰

**v1.1 æ›´æ–°å†…å®¹ï¼š**

- è¡¥å……å®ä½“å­—æ®µï¼š`classificationLevel1Name`ã€`classificationLevel2Name`ã€`existingVersionId`
- ä¿®å¤ 6.2 å¯¼å‡ºæ¥å£å“åº”ä½“ï¼ˆæ›¿æ¢ç‰ˆæœ¬åœºæ™¯ï¼‰
- ä¿®æ­£æ¥å£ç¼–å·ï¼ˆ6.4-6.8ï¼‰
- æ–°å¢ 6.9 å–æ¶ˆç”³è¯·æ¥å£
- æ–°å¢ 6.10 ç¼–è¾‘ç”³è¯·ä¿¡æ¯æ¥å£
- æ›´æ–°æƒé™å®šä¹‰ï¼Œå¢åŠ  `development:application:edit`
- ä¼˜åŒ–ç´¢å¼•è®¾è®¡è¯´æ˜ï¼Œæ˜ç¡®ç‰ˆæœ¬å·å”¯ä¸€æ€§æ ¡éªŒé€»è¾‘
