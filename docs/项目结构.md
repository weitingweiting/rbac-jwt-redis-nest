# ğŸ“– é¡¹ç›®ç»“æ„è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®çš„ç›®å½•ç»“æ„å’Œå„æ¨¡å—çš„èŒè´£ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
rbac+jwt+redis-DEMO/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.ts                   # åº”ç”¨å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ app.module.ts             # æ ¹æ¨¡å—
â”‚   â”œâ”€â”€ app.controller.ts         # æ ¹æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ app.service.ts            # æ ¹æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ modules/                  # ä¸šåŠ¡æ¨¡å—ç›®å½•
â”‚   â”‚   â”œâ”€â”€ auth/                 # è®¤è¯æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts    # è®¤è¯æ§åˆ¶å™¨ï¼ˆç™»å½•ã€æ³¨å†Œã€åˆ·æ–°ä»¤ç‰Œç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts       # è®¤è¯æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.module.ts        # è®¤è¯æ¨¡å—é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/                   # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login.dto.ts      # ç™»å½• DTO
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ register.dto.ts   # æ³¨å†Œ DTO
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ response.dto.ts   # å“åº” DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ guards/                # å®ˆå«
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ jwt-auth.guard.ts # JWT è®¤è¯å®ˆå«
â”‚   â”‚   â”‚   â”œâ”€â”€ strategies/            # Passport ç­–ç•¥
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ jwt.strategy.ts   # JWT ç­–ç•¥
â”‚   â”‚   â”‚   â””â”€â”€ decorators/            # è£…é¥°å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ current-user.decorator.ts  # å½“å‰ç”¨æˆ·è£…é¥°å™¨
â”‚   â”‚   â”‚       â””â”€â”€ public.decorator.ts        # å…¬å¼€æ¥å£è£…é¥°å™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ users/                # ç”¨æˆ·ç®¡ç†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ users.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ users.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ users.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â”œâ”€â”€ create-user.dto.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ update-user.dto.ts
â”‚   â”‚   â”‚       â””â”€â”€ query-user.dto.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ roles/                # è§’è‰²ç®¡ç†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ roles.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ roles.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ roles.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ permissions/          # æƒé™ç®¡ç†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ permissions.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ permissions.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ permissions.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ project-spaces/       # é¡¹ç›®ç©ºé—´æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ project-spaces.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ project-spaces.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ project-spaces.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ projects/             # é¡¹ç›®ç®¡ç†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ projects.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ projects.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ projects.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ project-assets/       # é¡¹ç›®èµ„æºæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ project-assets.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ project-assets.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ project-assets.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ queue/                # é˜Ÿåˆ—æ¨¡å—ï¼ˆBullMQï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ queue.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ queue.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ producers/         # ç”Ÿäº§è€…
â”‚   â”‚   â”‚   â””â”€â”€ processors/        # æ¶ˆè´¹è€…
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ validation-test/      # éªŒè¯æµ‹è¯•æ¨¡å—ï¼ˆå¼€å‘ç”¨ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/                   # å…±äº«æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ shared.module.ts      # å…±äº«æ¨¡å—é…ç½®
â”‚   â”‚   â”œâ”€â”€ entities/             # å®ä½“ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ base.entity.ts    # åŸºç¡€å®ä½“ï¼ˆid, createdAt, updatedAt, deletedAtï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ user.entity.ts    # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ role.entity.ts    # è§’è‰²å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.entity.ts      # æƒé™å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ project-space.entity.ts   # é¡¹ç›®ç©ºé—´å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ project.entity.ts         # é¡¹ç›®å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ project-asset.entity.ts   # é¡¹ç›®èµ„æºå®ä½“
â”‚   â”‚   â”œâ”€â”€ dto/                  # å…±äº« DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ base-user.dto.ts  # åŸºç¡€ç”¨æˆ· DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ current-user.dto.ts   # å½“å‰ç”¨æˆ· DTO
â”‚   â”‚   â”‚   â”œâ”€â”€ pagination.dto.ts     # åˆ†é¡µ DTO
â”‚   â”‚   â”‚   â””â”€â”€ user-operation.dto.ts # ç”¨æˆ·æ“ä½œ DTO
â”‚   â”‚   â”œâ”€â”€ config/               # é…ç½®æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ env.config.ts     # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ database.config.ts    # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.config.ts         # JWT é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ redis.config.ts       # Redis é…ç½®
â”‚   â”‚   â”œâ”€â”€ decorators/           # å…±äº«è£…é¥°å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ permissions.decorator.ts   # æƒé™è£…é¥°å™¨
â”‚   â”‚   â”‚   â””â”€â”€ exclude-soft-deleted.decorator.ts  # æ’é™¤è½¯åˆ é™¤è£…é¥°å™¨
â”‚   â”‚   â”œâ”€â”€ guards/               # å…±äº«å®ˆå«
â”‚   â”‚   â”‚   â””â”€â”€ permissions.guard.ts   # æƒé™å®ˆå«
â”‚   â”‚   â”œâ”€â”€ services/             # å…±äº«æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ token-blacklist.service.ts     # Token é»‘åå•æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ user-permissions.service.ts    # ç”¨æˆ·æƒé™æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ exceptions/           # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”‚   â”‚   â”œâ”€â”€ business.exception.ts      # ä¸šåŠ¡å¼‚å¸¸
â”‚   â”‚   â”‚   â””â”€â”€ error-codes.ts             # é”™è¯¯ç å®šä¹‰
â”‚   â”‚   â””â”€â”€ constants/            # å¸¸é‡å®šä¹‰
â”‚   â”‚       â””â”€â”€ queue.constant.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ common/                   # é€šç”¨åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ filters/              # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ http-exception.filter.ts       # HTTP å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”‚   â”‚   â””â”€â”€ all-exceptions.filter.ts       # å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”‚   â”œâ”€â”€ interceptors/         # æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ response-transform.interceptor.ts  # å“åº”è½¬æ¢æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ logging.interceptor.ts             # æ—¥å¿—æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â””â”€â”€ soft-delete.interceptor.ts         # è½¯åˆ é™¤æ‹¦æˆªå™¨
â”‚   â”‚   â”œâ”€â”€ pipes/                # ç®¡é“
â”‚   â”‚   â”‚   â””â”€â”€ validation.pipe.ts     # å…¨å±€éªŒè¯ç®¡é“
â”‚   â”‚   â”œâ”€â”€ middleware/           # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ logger.middleware.ts   # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ logger/               # æ—¥å¿—æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ winston.config.ts
â”‚   â”‚   â”œâ”€â”€ services/             # é€šç”¨æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ base.service.ts   # åŸºç¡€ CRUD æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ validators/           # è‡ªå®šä¹‰éªŒè¯å™¨
â”‚   â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚
â”‚   â””â”€â”€ database/                 # æ•°æ®åº“ç›¸å…³
â”‚       â”œâ”€â”€ database.module.ts    # æ•°æ®åº“æ¨¡å—
â”‚       â”œâ”€â”€ migrations/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚       â””â”€â”€ seeds/                # æ•°æ®åº“ç§å­æ•°æ®
â”‚           â”œâ”€â”€ seed.ts           # Seed å…¥å£æ–‡ä»¶
â”‚           â”œâ”€â”€ seed.module.ts    # Seed æ¨¡å—
â”‚           â””â”€â”€ seed.service.ts   # Seed æœåŠ¡
â”‚
â”œâ”€â”€ bruno-api-tests/              # API æµ‹è¯•é›†åˆï¼ˆBrunoï¼‰
â”‚   â”œâ”€â”€ Auth/                     # è®¤è¯æ¥å£æµ‹è¯•
â”‚   â”œâ”€â”€ Users/                    # ç”¨æˆ·æ¥å£æµ‹è¯•
â”‚   â”œâ”€â”€ RBAC/                     # æƒé™æ¥å£æµ‹è¯•
â”‚   â””â”€â”€ environments/             # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md
â”‚   â”œâ”€â”€ éƒ¨ç½²æŒ‡å—.md
â”‚   â”œâ”€â”€ é¡¹ç›®ç»“æ„.md
â”‚   â”œâ”€â”€ APIæ¥å£.md
â”‚   â”œâ”€â”€ å¼€å‘æŒ‡å—.md
â”‚   â””â”€â”€ æ—¥å¿—ç³»ç»Ÿ.md
â”‚
â”œâ”€â”€ scripts/                      # è„šæœ¬æ–‡ä»¶
â”‚   â”œâ”€â”€ ensure-logs-dir.js        # ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨
â”‚   â”œâ”€â”€ generate-password-hash.js # ç”Ÿæˆå¯†ç å“ˆå¸Œ
â”‚   â””â”€â”€ test-validation.sh        # éªŒè¯æµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶ç›®å½•ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”œâ”€â”€ dist/                         # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ node_modules/                 # ä¾èµ–åŒ…ç›®å½•
â”‚
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæœ¬åœ°ï¼‰
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                    # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .prettierrc                   # Prettier é…ç½®
â”œâ”€â”€ eslint.config.js              # ESLint é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”œâ”€â”€ nest-cli.json                 # NestJS CLI é…ç½®
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ pnpm-lock.yaml                # pnpm é”æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml            # Docker Compose é…ç½®
â”œâ”€â”€ redis.conf                    # Redis é…ç½®æ–‡ä»¶
â”œâ”€â”€ init.sql                      # æ•°æ®åº“åˆå§‹åŒ– SQL è„šæœ¬
â”œâ”€â”€ Makefile                      # Make å‘½ä»¤é›†åˆ
â””â”€â”€ README.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Controller Layer           â”‚  â† HTTP è¯·æ±‚å¤„ç†
â”‚    (è·¯ç”±ã€å‚æ•°éªŒè¯ã€æƒé™æ£€æŸ¥)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Service Layer              â”‚  â† ä¸šåŠ¡é€»è¾‘
â”‚    (ä¸šåŠ¡è§„åˆ™ã€æ•°æ®å¤„ç†ã€äº‹åŠ¡)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Repository Layer            â”‚  â† æ•°æ®è®¿é—®
â”‚    (TypeORMã€æ•°æ®åº“æ“ä½œ)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Database Layer              â”‚  â† æ•°æ®æŒä¹…åŒ–
â”‚         (MySQL + Redis)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—ä¾èµ–å…³ç³»

```
AppModule (æ ¹æ¨¡å—)
â”œâ”€â”€ ConfigModule (é…ç½®æ¨¡å—)
â”œâ”€â”€ DatabaseModule (æ•°æ®åº“æ¨¡å—)
â”œâ”€â”€ LoggerModule (æ—¥å¿—æ¨¡å—)
â”œâ”€â”€ SharedModule (å…±äº«æ¨¡å—)
â”‚   â”œâ”€â”€ TokenBlacklistService
â”‚   â”œâ”€â”€ UserPermissionsService
â”‚   â””â”€â”€ PermissionsGuard
â”œâ”€â”€ AuthModule (è®¤è¯æ¨¡å—)
â”‚   â”œâ”€â”€ depends on: SharedModule, UsersModule
â”‚   â”œâ”€â”€ JwtStrategy
â”‚   â”œâ”€â”€ JwtAuthGuard
â”‚   â””â”€â”€ AuthService
â”œâ”€â”€ UsersModule (ç”¨æˆ·æ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule
â”œâ”€â”€ RolesModule (è§’è‰²æ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule
â”œâ”€â”€ PermissionsModule (æƒé™æ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule
â”œâ”€â”€ ProjectSpacesModule (é¡¹ç›®ç©ºé—´æ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule, AuthModule
â”œâ”€â”€ ProjectsModule (é¡¹ç›®æ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule, AuthModule
â”œâ”€â”€ ProjectAssetsModule (é¡¹ç›®èµ„æºæ¨¡å—)
â”‚   â””â”€â”€ depends on: SharedModule, AuthModule
â””â”€â”€ QueueModule (é˜Ÿåˆ—æ¨¡å—)
    â””â”€â”€ depends on: BullModule (Redis)
```

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. AuthModuleï¼ˆè®¤è¯æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- ç”¨æˆ·ç™»å½•ã€æ³¨å†Œ
- JWT Token ç­¾å‘å’ŒéªŒè¯
- Token åˆ·æ–°
- ç”¨æˆ·ç™»å‡ºï¼ˆToken é»‘åå•ï¼‰

**å…³é”®æ–‡ä»¶ï¼š**

- `jwt.strategy.ts` - JWT éªŒè¯ç­–ç•¥
- `jwt-auth.guard.ts` - JWT è®¤è¯å®ˆå«
- `auth.service.ts` - è®¤è¯ä¸šåŠ¡é€»è¾‘

### 2. UsersModuleï¼ˆç”¨æˆ·æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- ç”¨æˆ· CRUD æ“ä½œ
- ç”¨æˆ·è§’è‰²åˆ†é…
- ç”¨æˆ·æŸ¥è¯¢å’Œåˆ†é¡µ

**å…³é”®ç‰¹æ€§ï¼š**

- è½¯åˆ é™¤æ”¯æŒ
- å¯†ç  SHA-256 åŠ å¯†
- ç”¨æˆ·æƒé™ç¼“å­˜

### 3. RolesModuleï¼ˆè§’è‰²æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- è§’è‰² CRUD æ“ä½œ
- è§’è‰²æƒé™åˆ†é…
- è§’è‰²æŸ¥è¯¢

**é¢„å®šä¹‰è§’è‰²ï¼š**

- `admin` - ç®¡ç†å‘˜ï¼ˆæ‰€æœ‰æƒé™ï¼‰
- `editor` - ç¼–è¾‘è€…ï¼ˆæŸ¥çœ‹ã€åˆ›å»ºã€æ›´æ–°ã€å‘å¸ƒï¼‰
- `viewer` - æŸ¥çœ‹è€…ï¼ˆä»…æŸ¥çœ‹æƒé™ï¼‰

### 4. PermissionsModuleï¼ˆæƒé™æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- æƒé™ CRUD æ“ä½œ
- æƒé™æŸ¥è¯¢

**æƒé™å‘½åè§„èŒƒï¼š**

```
<èµ„æº>.<æ“ä½œ>

ç¤ºä¾‹ï¼š
- user.read
- user.create
- user.update
- user.delete
- project.publish
```

### 5. SharedModuleï¼ˆå…±äº«æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- æä¾›è·¨æ¨¡å—å…±äº«çš„åŠŸèƒ½
- å®ä½“ç±»å®šä¹‰
- é€šç”¨ DTO
- å…±äº«æœåŠ¡å’Œå®ˆå«

**å…³é”®æœåŠ¡ï¼š**

- `TokenBlacklistService` - Token é»‘åå•ç®¡ç†ï¼ˆRedisï¼‰
- `UserPermissionsService` - ç”¨æˆ·æƒé™æŸ¥è¯¢å’Œç¼“å­˜
- `PermissionsGuard` - åŸºäºæƒé™çš„è®¿é—®æ§åˆ¶

### 6. CommonModuleï¼ˆé€šç”¨æ¨¡å—ï¼‰

**èŒè´£ï¼š**

- å…¨å±€è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨ã€ç®¡é“
- æ—¥å¿—ç³»ç»Ÿ
- åŸºç¡€æœåŠ¡ç±»

**å…³é”®ç»„ä»¶ï¼š**

- `AllExceptionsFilter` - å…¨å±€å¼‚å¸¸å¤„ç†
- `ResponseTransformInterceptor` - ç»Ÿä¸€å“åº”æ ¼å¼
- `LoggingInterceptor` - è¯·æ±‚æ—¥å¿—è®°å½•
- `BaseService` - åŸºç¡€ CRUD æœåŠ¡ï¼ˆæ”¯æŒè½¯åˆ é™¤ï¼‰

## ğŸ” æƒé™ç³»ç»Ÿè®¾è®¡

### RBAC æ¨¡å‹

```
User (ç”¨æˆ·) â”€â”¬â”€â–º Role (è§’è‰²) â”€â”¬â”€â–º Permission (æƒé™)
             â”‚                â”‚
             â”‚                â””â”€â–º Permission
             â”‚
             â””â”€â–º Role â”€â”€â”€â”€â”€â”€â”€â”¬â”€â–º Permission
                              â”‚
                              â””â”€â–º Permission
```

### æƒé™æ£€æŸ¥æµç¨‹

```
1. è¯·æ±‚åˆ°è¾¾
   â†“
2. JwtAuthGuard (éªŒè¯ JWT Token)
   â†“
3. PermissionsGuard (æ£€æŸ¥æƒé™)
   â”œâ”€â–º ä»è£…é¥°å™¨è·å–æ‰€éœ€æƒé™
   â”œâ”€â–º ä» Redis ç¼“å­˜è·å–ç”¨æˆ·æƒé™
   â”‚   â””â”€â–º ç¼“å­˜æœªå‘½ä¸­ â†’ ä»æ•°æ®åº“æŸ¥è¯¢ â†’ å†™å…¥ç¼“å­˜
   â””â”€â–º æ¯”è¾ƒæ‰€éœ€æƒé™å’Œç”¨æˆ·æƒé™
   â†“
4. å…è®¸/æ‹’ç»è®¿é—®
```

### æƒé™è£…é¥°å™¨ä½¿ç”¨

```typescript
// å•ä¸ªæƒé™
@RequirePermissions('user.read')
async findAll() { ... }

// å¤šä¸ªæƒé™ï¼ˆAND å…³ç³»ï¼‰
@RequirePermissions('user.read', 'user.update')
async update() { ... }

// å…¬å¼€æ¥å£ï¼ˆè·³è¿‡æƒé™æ£€æŸ¥ï¼‰
@Public()
async publicEndpoint() { ... }
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### å®ä½“å…³ç³»å›¾ï¼ˆERDï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚  user_roles â”‚â—„â”€â”€â”€â”€â”€â”€â”‚     Role     â”‚
â”‚  (ç”¨æˆ·)     â”‚ n:m   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   n:m â”‚   (è§’è‰²)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                             â”‚
      â”‚ 1:n                                     n:m â”‚
      â”‚                                             â”‚
      â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ProjectSpace â”‚                         â”‚role_permissions  â”‚
â”‚(é¡¹ç›®ç©ºé—´)   â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
       â”‚ 1:n                                    n:m â”‚
       â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Project   â”‚                         â”‚   Permission     â”‚
â”‚  (é¡¹ç›®)     â”‚                         â”‚    (æƒé™)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1:n
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ProjectAsset â”‚
â”‚(é¡¹ç›®èµ„æº)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è½¯åˆ é™¤æœºåˆ¶

æ‰€æœ‰å®ä½“ç»§æ‰¿è‡ª `BaseEntity`ï¼ŒåŒ…å«ï¼š

- `id` - ä¸»é”®
- `createdAt` - åˆ›å»ºæ—¶é—´
- `updatedAt` - æ›´æ–°æ—¶é—´
- `deletedAt` - è½¯åˆ é™¤æ—¶é—´ï¼ˆNULL è¡¨ç¤ºæœªåˆ é™¤ï¼‰

## ğŸ“ API å“åº”æ ¼å¼

### æˆåŠŸå“åº”

```json
{
  "code": 200,
  "message": "Success",
  "data": { ... },
  "timestamp": "2025-11-30T00:00:00.000Z"
}
```

### é”™è¯¯å“åº”

```json
{
  "code": 400,
  "message": "ä¸šåŠ¡é”™è¯¯æè¿°",
  "error": "BUSINESS_ERROR",
  "timestamp": "2025-11-30T00:00:00.000Z"
}
```

## ğŸ” æ—¥å¿—ç³»ç»Ÿ

### æ—¥å¿—çº§åˆ«

- `error` - é”™è¯¯æ—¥å¿—
- `warn` - è­¦å‘Šæ—¥å¿—
- `info` - ä¿¡æ¯æ—¥å¿—
- `debug` - è°ƒè¯•æ—¥å¿—

### æ—¥å¿—æ–‡ä»¶

```
logs/
â”œâ”€â”€ error/
â”‚   â””â”€â”€ error-YYYY-MM-DD.log     # é”™è¯¯æ—¥å¿—ï¼ˆä¿ç•™30å¤©ï¼‰
â”œâ”€â”€ combined/
â”‚   â””â”€â”€ combined-YYYY-MM-DD.log  # æ‰€æœ‰æ—¥å¿—ï¼ˆä¿ç•™7å¤©ï¼‰
â””â”€â”€ exceptions/
    â””â”€â”€ exceptions-YYYY-MM-DD.log # æœªæ•è·å¼‚å¸¸ï¼ˆä¿ç•™30å¤©ï¼‰
```

## ğŸ§ª æµ‹è¯•ç»“æ„

```
bruno-api-tests/
â”œâ”€â”€ Auth/                    # è®¤è¯æµ‹è¯•
â”‚   â”œâ”€â”€ 01-register-success.bru
â”‚   â”œâ”€â”€ 10-login-success.bru
â”‚   â”œâ”€â”€ 20-profile-success.bru
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Users/                   # ç”¨æˆ·ç®¡ç†æµ‹è¯•
â”‚   â”œâ”€â”€ 01-list-users-basic.bru
â”‚   â”œâ”€â”€ 10-get-user-success.bru
â”‚   â””â”€â”€ ...
â”œâ”€â”€ RBAC/                    # æƒé™æµ‹è¯•
â”‚   â”œâ”€â”€ 01-admin-route-success.bru
â”‚   â”œâ”€â”€ 02-profile-permission.bru
â”‚   â””â”€â”€ ...
â””â”€â”€ environments/            # æµ‹è¯•ç¯å¢ƒé…ç½®
    â”œâ”€â”€ global.bru
    â””â”€â”€ local.bru
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹](./å¿«é€Ÿå¼€å§‹.md)
- [API æ–‡æ¡£](./APIæ¥å£.md)
- [å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md)
- [éƒ¨ç½²æŒ‡å—](./éƒ¨ç½²æŒ‡å—.md)
